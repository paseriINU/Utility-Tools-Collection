# JP1 ローカルジョブ起動ツール

JP1/AJS3のジョブネットをローカルで起動するバッチファイルです。

## 概要

- JP1/AJS3がインストールされているサーバ上で直接実行
- `ajsentry` でジョブネットを即時起動
- `ajsstatus` でジョブ完了を待機（オプション）
- `ajsshow -E` で詳細情報を取得

## 必要な環境

- Windows Server（JP1/AJS3がインストールされていること）
- JP1/AJS3 コマンドへのアクセス権限（パスが通っていること）

## 特徴

| 項目 | 説明 |
|------|------|
| 実行方式 | ローカル実行（JP1サーバ上で直接実行） |
| 管理者権限 | 不要 |
| 完了待ち | 対応（ajsstatusでポーリング） |
| タイムアウト | 設定可能（デフォルト:無制限） |

## 使い方

### 1. 設定を編集

`JP1_ローカルジョブ起動ツール.bat` の設定セクションを編集します：

```batch
rem スケジューラーサービス名（通常は AJSROOT1）
set "SCHEDULER_SERVICE=AJSROOT1"

rem 起動するジョブネットのフルパス
set "JOBNET_PATH=/main_unit/jobgroup1/daily_batch"

rem ジョブ完了を待つ場合は 1、起動のみの場合は 0
set "WAIT_FOR_COMPLETION=1"

rem 完了待ちのタイムアウト（秒）。0の場合は無制限
set "WAIT_TIMEOUT=0"
```

### 2. 実行

JP1/AJS3サーバ上でバッチファイルをダブルクリックして実行します。

### 3. 実行例

```
================================================================
  JP1 ローカルジョブ起動ツール
================================================================

設定情報:
  スケジューラー   : AJSROOT1
  ジョブネットパス : /main_unit/jobgroup1/daily_batch
  完了待ち         : 有効
  タイムアウト     : 無制限

================================================================
ジョブネット起動中...
================================================================

コマンド実行中: ajsentry -F AJSROOT1 /main_unit/jobgroup1/daily_batch

----------------------------------------------------------------
ajsentry出力:
KAVS1820-I ajsentryコマンドが正常終了しました。
----------------------------------------------------------------

[OK] ジョブネットの起動に成功しました

================================================================
ジョブ完了待機中...
================================================================

  状態: 実行中... (経過時間: 0分10秒)
  状態: 実行中... (経過時間: 0分20秒)
  状態: 実行中... (経過時間: 0分30秒)

================================================================
[OK] ジョブネットが正常終了しました
================================================================

================================================================
処理サマリー
================================================================

  ジョブネット: /main_unit/jobgroup1/daily_batch
  起動結果    : 成功
  実行結果    : 正常終了

処理が完了しました。
```

## 設定項目

| 設定項目 | 説明 | デフォルト値 |
|---------|------|-------------|
| `SCHEDULER_SERVICE` | スケジューラーサービス名 | `AJSROOT1` |
| `JOBNET_PATH` | 起動するジョブネットのパス | `/main_unit/jobgroup1/daily_batch` |
| `WAIT_FOR_COMPLETION` | 完了待ち（1:有効、0:無効） | `1` |
| `WAIT_TIMEOUT` | タイムアウト（秒、0:無制限） | `0` |
| `POLLING_INTERVAL` | 状態確認間隔（秒） | `10` |

## リモートジョブ起動ツールとの違い

| 項目 | 本ツール | リモートジョブ起動ツール |
|------|---------|------------------------|
| 実行場所 | JP1サーバ上で直接実行 | クライアントPCから実行 |
| WinRM | 不要 | 必要 |
| 管理者権限 | 不要 | 必要（クライアント側） |
| JP1インストール | 実行サーバに必要 | 実行サーバに不要 |

## 注意事項

- JP1/AJS3がインストールされているサーバ上で実行してください
- JP1コマンドにパスが通っている必要があります
- ジョブネットパスは `/` から始まるフルパスで指定してください

## トラブルシューティング

### ajsentryコマンドが見つかりません

JP1/AJS3コマンドにパスが通っているか確認してください。

### ジョブネットが見つかりません

- ジョブネットパスが正しいか確認してください
- `/` から始まるフルパスで指定してください
- ajsprint コマンドで存在を確認してください：
  ```cmd
  ajsprint -F AJSROOT1 /main_unit -R
  ```

## 関連ツール

- [JP1 リモートジョブ起動ツール](../JP1_リモートジョブ起動ツール/) - リモートPCからJP1ジョブを起動
- [JP1 ジョブログ取得ツール](../JP1_ジョブログ取得ツール/) - ジョブスプールを取得

## 使用コマンド

- `ajsentry` - ジョブネット即時実行
- `ajsstatus` - 実行状態取得
- `ajsshow -E` - 詳細情報取得

詳細は [JP1_AJS3_COMMANDS.md](../JP1_リモートジョブ起動ツール/JP1_AJS3_COMMANDS.md) を参照してください。

## ライセンス

MIT License
