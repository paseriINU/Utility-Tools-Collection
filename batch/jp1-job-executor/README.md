# JP1ジョブネット起動ツール

ローカルPCから**JP1/AJS3のジョブネット**を起動するためのツール群です。

3つの異なるアプローチで実装されており、環境に応じて選択できます。

---

## 📁 フォルダ構成

```
jp1-job-executor/
├── ajsentry-direct/       # 方法1: ajsentryコマンド版（標準）
│   ├── jp1_start_job.bat
│   ├── jp1_start_job_config.bat
│   └── config.ini.sample
│
├── remote-exec/           # 方法2: リモート実行版
│   ├── jp1_remote_start.bat
│   └── config.ini.sample
│
└── rest-api/              # 方法3: REST API版
    ├── Start-JP1Job.ps1
    ├── jp1_start_api.bat
    └── config.ini.sample
```

---

## 🚀 3つのアプローチ

### 方法1: ajsentryコマンド版（標準的な方法）

**特徴**:
- ✅ JP1の標準コマンド`ajsentry`を使用
- ✅ 最もシンプルで信頼性が高い
- ✅ ローカルにJP1/AJS3 - Viewまたは- Managerのインストールが必要

**使用条件**:
- JP1/AJS3 - ViewまたはJP1/AJS3 - Managerがインストール済み
- `ajsentry`コマンドが使用可能

**詳細**: [ajsentry-direct/README.md](ajsentry-direct/README.md)

---

### 方法2: リモート実行版

**特徴**:
- ✅ PowerShell Remotingを使用してリモートサーバで`ajsentry`を実行
- ✅ ローカルにJP1のインストール不要
- ✅ 既存のリモート実行ツールと同じ仕組み

**使用条件**:
- JP1サーバ上でPowerShell Remotingが有効
- WinRMサービスが稼働
- リモートサーバへのアクセス権限

**詳細**: [remote-exec/README.md](remote-exec/README.md)

---

### 方法3: REST API版（最新）

**特徴**:
- ✅ JP1/AJS3のREST APIを使用
- ✅ ローカルにJP1のインストール不要
- ✅ HTTP/HTTPSで通信（ファイアウォール設定が簡単）
- ⚠️ JP1/AJS3 - Manager バージョン10以降が必要

**使用条件**:
- JP1/AJS3 - Manager バージョン10以降
- REST APIサービスが有効
- ネットワークでポート22250（デフォルト）が開いている

**詳細**: [rest-api/README.md](rest-api/README.md)

---

## 📊 比較表

| 項目 | ajsentryコマンド版 | リモート実行版 | REST API版 |
|------|-------------------|---------------|-----------|
| **ローカルJP1必要** | ✅ 必要 | ❌ 不要 | ❌ 不要 |
| **セットアップ難易度** | ⭐ 簡単 | ⭐⭐ 中程度 | ⭐⭐ 中程度 |
| **JP1バージョン要件** | すべて | すべて | 10以降 |
| **通信プロトコル** | JP1独自 | WinRM (5985/5986) | HTTP/HTTPS (22250) |
| **認証方法** | JP1認証 | Windows認証+JP1認証 | JP1認証 |
| **ファイアウォール設定** | JP1ポート | WinRM | HTTP/HTTPS |
| **推奨用途** | 標準的な環境 | JP1未インストールPC | モダンな環境 |

---

## 🎯 どれを選ぶべきか？

### ajsentryコマンド版を選ぶ場合:
- ✅ ローカルにJP1/AJS3がインストール済み
- ✅ 標準的な方法を使いたい
- ✅ 既存のJP1環境と統一したい

### リモート実行版を選ぶ場合:
- ✅ ローカルにJP1をインストールできない
- ✅ PowerShell Remotingが既に設定済み
- ✅ 複数のサーバで実行する可能性がある

### REST API版を選ぶ場合:
- ✅ JP1/AJS3 - Manager バージョン10以降を使用
- ✅ モダンなAPI連携をしたい
- ✅ ファイアウォール設定を簡素化したい
- ✅ 将来的に他のシステムとの連携を考えている

---

## 🔧 共通の前提条件

すべてのアプローチに共通する要件:

1. **JP1/AJS3サーバが稼働中**
   - ジョブネットが登録済み
   - JP1サービスが起動中

2. **ネットワーク接続**
   - ローカルPCからJP1サーバへアクセス可能

3. **JP1認証情報**
   - JP1ユーザー名とパスワード
   - ジョブネット実行権限

4. **ジョブネット情報**
   - ジョブネットのフルパス（例: `/main_unit/jobgroup1/daily_batch`）

---

## 📖 使い方

各アプローチの詳細な使い方は、それぞれのフォルダ内のREADME.mdを参照してください。

1. **ajsentryコマンド版**: [ajsentry-direct/README.md](ajsentry-direct/README.md)
2. **リモート実行版**: [remote-exec/README.md](remote-exec/README.md)
3. **REST API版**: [rest-api/README.md](rest-api/README.md)

---

## ⚠️ 注意事項

### セキュリティ

- **パスワード管理**: バッチファイル内にパスワードを直接記載しないことを推奨
- **設定ファイル**: config.iniは`.gitignore`に追加してコミットしない
- **権限管理**: ジョブネット実行権限を持つユーザーのみが使用すること

### JP1環境

- **本番環境**: 本番環境での実行前に必ずテスト環境で動作確認
- **ジョブネット状態**: 既に実行中のジョブネットを再起動する場合は注意
- **スケジュール**: 定期実行されているジョブネットとの競合に注意

---

## 🐛 トラブルシューティング

### 共通のエラー

#### エラー: 「認証に失敗しました」
- JP1ユーザー名、パスワードを確認
- JP1サーバが稼働中か確認
- ネットワーク接続を確認

#### エラー: 「ジョブネットが見つかりません」
- ジョブネットパスが正しいか確認（例: `/main_unit/group/jobnet`）
- ジョブネットが登録されているか確認
- パスの大文字小文字を確認

#### エラー: 「接続できません」
- ファイアウォール設定を確認
- JP1サービスが起動しているか確認
- ホスト名/IPアドレスが正しいか確認

詳細なトラブルシューティングは各アプローチのREADME.mdを参照してください。

---

## 📝 ライセンス

このツールはMITライセンスで提供されています。詳細はリポジトリルートの[LICENSE](../../LICENSE)ファイルを参照してください。

---

**更新日**: 2025-12-02
