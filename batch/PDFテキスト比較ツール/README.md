# PDF テキスト比較ツール

2つのPDFファイルのテキストを抽出し、WinMergeで比較するGUIツールです。

## 機能

- **ドラッグ&ドロップ対応**: PDFファイルをウィンドウにドラッグ&ドロップで選択
- **クリック選択**: ドロップゾーンをクリックしてファイル選択ダイアログから選択
- **WordでPDF変換**: Microsoft WordのPDF読み込み機能でテキスト抽出
- **WinMerge連携**: 抽出したテキストをWinMergeで差分比較

## 必要な環境

- **Windows 10/11**
- **Microsoft Word 2013 以降**（PDFを開く機能が必要）
- **WinMerge**（https://winmerge.org/）
- **PowerShell 5.1 以降**（Windows標準搭載）

## 使い方

### 1. ツールを起動
`PDFテキスト比較ツール.bat` をダブルクリックして実行します。

### 2. PDFファイルを選択
GUIウィンドウが表示されます。

```
┌─────────────────────────────────┐
│  PDF テキスト比較ツール          │
├─────────────────────────────────┤
│  旧PDF（比較元）:               │
│  ┌───────────────────────────┐  │
│  │  ドラッグ&ドロップ or クリック │  │
│  └───────────────────────────┘  │
│  新PDF（比較先）:               │
│  ┌───────────────────────────┐  │
│  │  ドラッグ&ドロップ or クリック │  │
│  └───────────────────────────┘  │
│        [比較実行]               │
└─────────────────────────────────┘
```

**選択方法**:
- PDFファイルをドロップゾーンにドラッグ&ドロップ
- または、ドロップゾーンをクリックしてファイル選択ダイアログから選択

### 3. 比較実行
「比較実行」ボタンをクリックすると:
1. Wordで各PDFを開いてテキストを抽出
2. 一時ファイルに保存（`%TEMP%`フォルダ）
3. WinMergeで差分比較を表示

## ファイル構成

```
PDFテキスト比較ツール/
└── PDFテキスト比較ツール.bat  # メインツール（PowerShell GUI）
```

## 注意事項

- **PDFの種類**: スキャン画像のPDF（画像ベース）はテキスト抽出できません
- **処理時間**: ページ数が多いPDFは処理に時間がかかります
- **一時ファイル**: 抽出したテキストは`%TEMP%`フォルダに保存されます
- **文字化け**: PDFのフォント埋め込み状況によっては文字化けする場合があります

## トラブルシューティング

### WinMergeが見つからない
WinMergeをインストールしてください:
- ダウンロード: https://winmerge.org/

### PDFが開けない
- Word 2013以降がインストールされているか確認
- PDFが暗号化されていないか確認
- PDFが破損していないか確認

### テキストが抽出されない
- スキャン画像ベースのPDFの可能性があります
- OCR処理されていないPDFはテキスト抽出できません

## ライセンス

MIT License
