# Git ブランチ上書きツール

指定したGitブランチの内容を、別のブランチの内容で完全に上書きするツールです。

## 概要

`git reset --hard` 方式を使用して、ターゲットブランチをソースブランチの内容で完全に置き換えます。履歴も含めて完全に同一になります。

## 使用例

- `develop` ブランチを `main` ブランチの内容で上書きする
- 古いフィーチャーブランチを最新の `develop` で更新する
- 誤った変更をしたブランチを別のブランチで復元する

## 必要な環境

- Windows 10 / 11
- PowerShell 5.1 以降
- Git for Windows

## 使い方

1. **バッチファイルをGitリポジトリ内で実行**
   ```
   Git_ブランチ上書きツール.bat
   ```
   ※ リポジトリ外で実行した場合はエラーになります

2. **ソースブランチを選択**（コピー元）
   - 一覧から番号で選択
   - このブランチの内容がコピーされます

3. **ターゲットブランチを選択**（上書き対象）
   - 一覧から番号で選択
   - このブランチが上書きされます
   - ※ main/master は保護のため選択不可

4. **バックアップの作成を選択**
   - 推奨: バックアップを作成する
   - バックアップブランチ名: `backup/[ブランチ名]_[日時]`

5. **リモートプッシュを選択**
   - リモートに反映する場合は `--force-with-lease` でプッシュ
   - ローカルのみの変更も可能

6. **最終確認**
   - `yes` と入力して実行

## 実行される操作

```bash
# バックアップ作成（オプション）
git branch backup/target_20241216_123456 target

# ターゲットブランチにチェックアウト
git checkout target

# ソースブランチの内容で上書き
git reset --hard source

# リモートにプッシュ（オプション）
git push --force-with-lease origin target
```

## 機能

### 安全機能

- **main/master 保護**: main/master ブランチは上書き対象として選択不可
- **バックアップ作成**: 上書き前に自動でバックアップブランチを作成可能
- **複数回の確認**: 各ステップで確認プロンプトを表示
- **最終確認**: `yes` の完全入力を要求（誤操作防止）

### 表示機能

- 現在のリポジトリパスとブランチを表示
- コミットされていない変更がある場合に警告
- 実行内容のプレビュー
- 処理完了後の状態表示

## 注意事項

1. **取り消し不可**: `git reset --hard` は取り消せません。必ずバックアップを作成してください。

2. **force-with-lease**: リモートへのプッシュには `--force-with-lease` が使用されます。他の人がプッシュした場合は失敗し、安全です。

3. **未コミット変更**: 作業中の変更がある場合は、事前にコミットまたはスタッシュしてください。

4. **保護ブランチ**: GitHub/GitLab等で保護されているブランチは、force pushがブロックされる場合があります。

## 元に戻す方法

バックアップを作成した場合:

```bash
# ターゲットブランチにチェックアウト
git checkout target

# バックアップから復元
git reset --hard backup/target_20241216_123456

# リモートに反映（必要な場合）
git push --force-with-lease origin target
```

## トラブルシューティング

### 「Gitリポジトリではありません」と表示される

- Gitリポジトリのディレクトリ内でバッチファイルを実行してください
- または、コマンドプロンプトで `cd` してからバッチファイルを実行してください

### プッシュに失敗する

- リモートリポジトリへの権限を確認してください
- 保護ブランチの設定を確認してください
- ネットワーク接続を確認してください

### 「ブランチが2つ以上必要です」と表示される

- ローカルに複数のブランチが必要です
- `git branch -a` でブランチを確認してください

## ライセンス

MIT License
