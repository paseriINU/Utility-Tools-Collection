# Gitブランチ管理ツール

## 概要

Gitのリモートブランチとローカルブランチを**数字で選択して削除**できる対話型ツールです。

### 特徴

- ✅ **数字で選択** - ブランチ名を入力せず番号で選択
- ✅ **一覧表示** - すべてのブランチを見やすく表示
- ✅ **安全な削除** - main/master/develop は保護
- ✅ **確認ダイアログ** - 削除前に必ず確認
- ✅ **リモート＆ローカル同時削除** - 両方を一度に削除可能

---

## 📁 ファイル構成

```
Git_ブランチ削除ツール/
├── Git_ブランチ削除ツール.bat  # ブランチ削除ツール
└── README.md
```

---

## 🚀 使い方

### 実行方法

**ファイル**: `Git_ブランチ削除ツール.bat`

リモート・ローカル・両方のブランチ削除機能がすべて含まれています。

#### 実行

1. Gitリポジトリのルートフォルダに配置
2. `Git_ブランチ削除ツール.bat` をダブルクリック
3. メニューから選択

```
========================================
Gitブランチ削除ツール
========================================

[1] リモートブランチを削除
[2] ローカルブランチを削除
[3] リモート＆ローカル両方を削除
[4] 終了

選択してください (1-4):
```

---

## 💡 機能説明

### 1. リモートブランチ削除

リモートリポジトリ（origin等）のブランチを削除します。

**コマンド相当**: `git push origin --delete <branch-name>`

**実行内容**:
1. リモートブランチ一覧を表示
2. 数字で選択
3. 確認後、リモートから削除

---

### 2. ローカルブランチ削除

ローカルリポジトリのブランチを削除します。

**コマンド相当**:
- `git branch -d <branch-name>` (通常削除)
- `git branch -D <branch-name>` (強制削除)

**削除モード**:

| モード | コマンド | 説明 |
|--------|---------|------|
| **通常削除** | `git branch -d` | マージ済みブランチのみ削除可能 |
| **強制削除** | `git branch -D` | マージされていなくても削除 |

---

### 3. リモート＆ローカル両方削除

同じ名前のリモートブランチとローカルブランチを一度に削除します。

**便利なケース**:
- マージ済みのフィーチャーブランチを完全に削除
- 不要になったブランチをクリーンアップ

**実行内容**:
1. ローカルとリモートの共通ブランチを検索
2. 数字で選択
3. リモートブランチを削除
4. ローカルブランチを削除

---

## 🛡️ 安全機能

### 保護ブランチ

以下のブランチは削除できません：

- `main`
- `master`
- `develop`

削除しようとすると警告が表示されます。

```
[警告] main/master/develop ブランチは保護されています。
このツールでは削除できません。
```

---

### 現在のブランチの保護

ローカルブランチ削除時、現在チェックアウトしているブランチは一覧に表示されません。

---

### 削除前の確認

すべての削除操作で確認ダイアログが表示されます。

```
削除しますか? (Y/N)
```

---

## 📊 使用例

### 例1: マージ済みフィーチャーブランチの削除

**シナリオ**: `feature/login` をmainにマージ後、ブランチを削除

```
1. Git_ブランチ削除ツール.bat を実行
2. [3] リモート＆ローカル両方を削除 を選択
3. feature/login を番号で選択
4. [1] 通常の削除 を選択
5. [Y] で確認
```

**結果**:
- リモートブランチ `origin/feature/login` 削除
- ローカルブランチ `feature/login` 削除

---

### 例2: 古いリモートブランチのクリーンアップ

**シナリオ**: リモートにある不要なブランチを削除

```
1. Git_ブランチ削除ツール.bat を実行
2. [1] リモートブランチを削除 を選択
3. 削除したいブランチを番号で選択
4. [Y] で確認
```

---

### 例3: 作業中ブランチの強制削除

**シナリオ**: マージしていないがもう不要なブランチを削除

```
1. Git_ブランチ削除ツール.bat を実行
2. [2] ローカルブランチを削除 を選択
3. 削除したいブランチを番号で選択
4. [2] 強制削除 を選択
5. 警告を確認後 [Y]
```

---

## 🔧 トラブルシューティング

### エラー: "Gitがインストールされていません"

**エラーメッセージ**:
```
========================================================================
  [エラー] Gitがインストールされていません
========================================================================
```

**解決方法**:
1. https://git-scm.com/download/win からGit for Windowsをインストール
2. インストール完了後、**新しいコマンドプロンプトを開いて**再実行

**確認方法**:
```cmd
git --version
```

---

### エラー: "このフォルダはGitリポジトリではありません"

**原因**: `.git` フォルダがない場所で実行している

**対処法**: Gitリポジトリのルートフォルダで実行してください

```cmd
cd C:\Projects\MyProject
Git_ブランチ削除ツール.bat
```

---

### エラー: "リモートリポジトリが設定されていません"

**原因**: リモートが設定されていない

**対処法**: リモートを追加してください

```bash
git remote add origin https://github.com/user/repo.git
```

---

### エラー: "リモートブランチの削除に失敗しました"

**原因1**: ネットワーク接続の問題

**対処法**: インターネット接続を確認

---

**原因2**: 権限不足

**対処法**: リポジトリへの書き込み権限を確認

---

**原因3**: ブランチが既に削除されている

**対処法**:
```bash
# リモートの状態を更新
git fetch --prune
```

---

### エラー: "ローカルブランチの削除に失敗しました"

**原因**: ブランチがマージされていない

**対処法1**: マージしてから削除

```bash
git checkout main
git merge feature/xxx
git branch -d feature/xxx
```

**対処法2**: 強制削除を選択

ツールで `[2] 強制削除` を選択

---

## 📋 Gitコマンド対応表

| ツール操作 | 対応するGitコマンド |
|----------|------------------|
| リモートブランチ削除 | `git push origin --delete <branch>` |
| ローカルブランチ削除（通常） | `git branch -d <branch>` |
| ローカルブランチ削除（強制） | `git branch -D <branch>` |
| ブランチ一覧（リモート） | `git branch -r` |
| ブランチ一覧（ローカル） | `git branch` |
| 現在のブランチ確認 | `git branch --show-current` |

---

## 💡 Tips

### リモートの古いブランチを一括確認

```bash
# リモートの状態を更新
git fetch --prune

# リモートブランチ一覧
git branch -r
```

---

### マージ済みブランチの確認

```bash
# マージ済みローカルブランチ
git branch --merged

# マージされていないローカルブランチ
git branch --no-merged
```

---

### リモートブランチ情報の更新

リモートで既に削除されたブランチをローカルから削除：

```bash
git fetch --prune
```

または、設定で自動化：

```bash
git config --global fetch.prune true
```

---

## 🔄 ワークフロー例

### フィーチャーブランチの完全削除フロー

1. **マージ**
   ```bash
   git checkout main
   git merge feature/new-feature
   git push origin main
   ```

2. **ブランチ削除**
   ```
   Git_ブランチ削除ツール.bat を実行
   [3] リモート＆ローカル両方を削除
   feature/new-feature を選択
   [1] 通常の削除
   ```

3. **完了！**
   - リモートとローカルの両方から削除完了

---

### 複数ブランチの一括削除

```
1. Git_ブランチ削除ツール.bat を実行
2. リモート/ローカルを選択
3. 1つ目のブランチを削除
4. メニューに戻る
5. 同じ操作を繰り返し
```

または、手動で一括削除：

```bash
# 複数のリモートブランチを一度に削除
git push origin --delete branch1 branch2 branch3
```

---

## ⚠️ 注意事項

### 1. 削除は取り消せません

一度削除したブランチは復元が困難です。
重要なブランチは慎重に削除してください。

### 2. マージされていないブランチ

強制削除すると、マージされていない変更は失われます。

### 3. 共同作業中

他の開発者が使用中のブランチを削除しないよう注意してください。

### 4. 保護ブランチ

main/master/developは保護されていますが、必要に応じて手動で削除できます：

```bash
# どうしても削除が必要な場合（非推奨）
git push origin --delete main
```

---

## 🎨 カスタマイズ

### 保護ブランチの追加

`Git_ブランチ削除ツール.bat` の設定セクションを編集：

```powershell
#region 設定セクション
# Gitプロジェクトのパス
$GIT_PROJECT_PATH = "C:\Users\$env:USERNAME\source\Git\project"

# 保護ブランチリスト（削除不可）
$ProtectedBranches = @("main", "master", "develop", "production")  # ← production を追加
#endregion
```

---

## ライセンス

このツールはMITライセンスの下で公開されています。

---

## 関連リンク

### Git公式ドキュメント

- [git branch](https://git-scm.com/docs/git-branch)
- [git push](https://git-scm.com/docs/git-push)
- [git fetch](https://git-scm.com/docs/git-fetch)

---

**作成日**: 2025-12-01
**バージョン**: 1.0
