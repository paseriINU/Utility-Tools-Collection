# ファイル拡張子解析ツール

指定フォルダとそのサブフォルダ内のファイル拡張子の種類とファイル数を解析するツールです。

## 概要

- フォルダ内のすべてのファイルを再帰的に検索
- 拡張子ごとにファイル数をカウント
- 割合（%）を計算して表示
- 拡張子別のファイル一覧表示
- CSV形式でのエクスポート機能

## 必要な環境

- Windows 10 / 11
- PowerShell 5.1以降（Windows標準搭載）

## 使い方

### 基本的な使い方

1. `ファイル拡張子解析ツール.bat` をダブルクリックして実行
2. フォルダの指定方法を選択
   - `1`: フォルダ選択ダイアログを使用
   - `2`: パスを直接入力
   - `0`: キャンセル
3. 解析結果が表示される
4. 詳細オプションを選択（オプション）
   - `1`: 特定の拡張子のファイル一覧を表示
   - `2`: CSVファイルにエクスポート
   - `0`: 終了

### ネットワークフォルダの指定

UNCパス（`\\server\share\folder`形式）にも対応しています。

## 実行例

```
================================================================
  ファイル拡張子解析ツール
================================================================

指定フォルダ内の拡張子の種類とファイル数を解析します。

フォルダの指定方法を選択してください:
 1. フォルダ選択ダイアログを使用
 2. パスを直接入力

 0. キャンセル

選択 (0-2): 2

フォルダパスを入力してください: C:\Projects\MyApp

----------------------------------------------------------------
解析対象: C:\Projects\MyApp
----------------------------------------------------------------

ファイルを検索しています...
検出ファイル数: 1234 件

================================================================
  拡張子一覧 (ファイル数降順)
================================================================

拡張子                ファイル数      割合
------------------------------------------
.cs                         456     37.0%
.json                       234     19.0%
.csproj                      89      7.2%
.xml                         78      6.3%
.config                      67      5.4%
.txt                         56      4.5%
.md                          45      3.6%
(拡張子なし)                  34      2.8%
...
------------------------------------------
合計                       1234    100.0%

================================================================
  サマリー
================================================================

  総ファイル数    : 1234 件
  拡張子の種類数  : 25 種類
  サブフォルダ数  : 89 件

  上位3拡張子:
    1. .cs (456 件, 37.0%)
    2. .json (234 件, 19.0%)
    3. .csproj (89 件, 7.2%)
```

## 出力ファイル

### CSVエクスポート

CSVエクスポートを選択すると、以下の形式でファイルが出力されます:

- ファイル名: `拡張子解析結果_YYYYMMDD_HHmmss.csv`
- 出力先: バッチファイルと同じフォルダ
- 文字コード: UTF-8（BOM付き）

```csv
"拡張子","ファイル数","割合(%)"
".cs","456","37.0"
".json","234","19.0"
...
"合計","1234","100.0"
```

## 注意事項

- アクセス権限のないフォルダは自動的にスキップされます
- 隠しファイルも含めてカウントされます
- 大量のファイルがある場合は解析に時間がかかることがあります
- 拡張子は小文字に統一して集計されます（`.TXT`と`.txt`は同一扱い）

## トラブルシューティング

### フォルダ選択ダイアログが表示されない

- PowerShellの実行ポリシーを確認してください
- 別の方法（パス直接入力）を使用してください

### アクセス拒否エラーが大量に表示される

- 管理者権限で実行すると、より多くのフォルダにアクセスできます
- ただし、システムフォルダなどは意図的にスキップされます

### 文字化けが発生する

- CSVファイルをExcelで開く場合は、「データ」→「テキストから」でUTF-8を指定して開いてください
- または、UTF-8対応のテキストエディタで開いてください

## ライセンス

MIT License
