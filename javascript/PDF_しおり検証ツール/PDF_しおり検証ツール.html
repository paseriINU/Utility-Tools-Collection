<!DOCTYPE html>
<!--
================================================================================
  PDF ã—ãŠã‚Šæ¤œè¨¼ãƒ„ãƒ¼ãƒ«
================================================================================
  ã“ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€PDFã®ã—ãŠã‚Šï¼ˆãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ï¼‰ã‚’æ¤œè¨¼ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
  å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã›ãšã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æ¨™æº–æ©Ÿèƒ½ã®ã¿ã§å‹•ä½œã—ã¾ã™ã€‚

  ã€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ ã€‘
  1. <!DOCTYPE html> - HTML5ã§ã‚ã‚‹ã“ã¨ã‚’å®£è¨€
  2. <html> - HTMLãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ«ãƒ¼ãƒˆè¦ç´ 
  3. <head> - ãƒ¡ã‚¿æƒ…å ±ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€ã‚¿ã‚¤ãƒˆãƒ«ãªã©ã‚’è¨˜è¿°
  4. <body> - ãƒšãƒ¼ã‚¸ã®å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¨˜è¿°
================================================================================
-->
<html lang="ja">
<!-- lang="ja" ã¯ã€ã“ã®ãƒšãƒ¼ã‚¸ãŒæ—¥æœ¬èªã§ã‚ã‚‹ã“ã¨ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¼ãˆã¾ã™ -->

<head>
    <!--
    ==========================================================================
      <head>ã‚»ã‚¯ã‚·ãƒ§ãƒ³
      ãƒšãƒ¼ã‚¸ã®ãƒ¡ã‚¿æƒ…å ±ï¼ˆè¦‹ãˆãªã„è¨­å®šéƒ¨åˆ†ï¼‰ã‚’å®šç¾©ã—ã¾ã™
    ==========================================================================
    -->

    <!-- æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«è¨­å®šï¼ˆæ—¥æœ¬èªã‚’æ­£ã—ãè¡¨ç¤ºã™ã‚‹ãŸã‚ï¼‰ -->
    <meta charset="UTF-8">

    <!-- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ç”¨ã®è¨­å®šï¼ˆã‚¹ãƒãƒ›ã§ã‚‚è¦‹ã‚„ã™ãã™ã‚‹ï¼‰ -->
    <!-- width=device-width: ç”»é¢å¹…ã«åˆã‚ã›ã‚‹ -->
    <!-- initial-scale=1.0: åˆæœŸã‚ºãƒ¼ãƒ ã‚’100%ã«è¨­å®š -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¿ã‚¤ãƒˆãƒ« -->
    <title>PDF ã—ãŠã‚Šæ¤œè¨¼ãƒ„ãƒ¼ãƒ«</title>

    <!--
    ==========================================================================
      <style>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ - CSSï¼ˆã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆï¼‰
      ãƒšãƒ¼ã‚¸ã®è¦‹ãŸç›®ï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ã‚’å®šç¾©ã—ã¾ã™

      ã€CSSã®åŸºæœ¬æ§‹æ–‡ã€‘
      ã‚»ãƒ¬ã‚¯ã‚¿ {
          ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: å€¤;
      }

      ä¾‹: body { color: red; }  â†’ bodyã‚¿ã‚°å†…ã®æ–‡å­—ã‚’èµ¤è‰²ã«
    ==========================================================================
    -->
    <style>
        /*
        ----------------------------------------------------------------------
          å…¨ä½“è¨­å®šï¼ˆãƒªã‚»ãƒƒãƒˆãƒ»åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
        ----------------------------------------------------------------------
        */

        /*
         * å…¨ç§°ã‚»ãƒ¬ã‚¯ã‚¿ï¼ˆ*ï¼‰: ã™ã¹ã¦ã®è¦ç´ ã«é©ç”¨
         * box-sizing: border-box ã¯ã€paddingã¨borderã‚’å«ã‚ãŸ
         * ã‚µã‚¤ã‚ºè¨ˆç®—ã‚’ã™ã‚‹ãŸã‚ã®é‡è¦ãªè¨­å®šã§ã™
         */
        * {
            box-sizing: border-box;
        }

        /*
         * bodyã‚¿ã‚°ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆãƒšãƒ¼ã‚¸å…¨ä½“ã®åŸºæœ¬è¨­å®šï¼‰
         * font-family: ä½¿ç”¨ã™ã‚‹ãƒ•ã‚©ãƒ³ãƒˆï¼ˆå·¦ã‹ã‚‰å„ªå…ˆé †ï¼‰
         * max-width: æœ€å¤§å¹…ã‚’1200pxã«åˆ¶é™ï¼ˆå¤§ç”»é¢ã§ã‚‚èª­ã¿ã‚„ã™ãï¼‰
         * margin: 0 auto ã¯ã€å·¦å³ã®ãƒãƒ¼ã‚¸ãƒ³ã‚’è‡ªå‹•è¨ˆç®—ã—ã¦ä¸­å¤®å¯„ã›
         * padding: å†…å´ã®ä½™ç™½
         * background-color: èƒŒæ™¯è‰²ï¼ˆ#f5f5f5 = è–„ã„ã‚°ãƒ¬ãƒ¼ï¼‰
         */
        body {
            font-family: 'Segoe UI', 'Meiryo', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        /*
        ----------------------------------------------------------------------
          è¦‹å‡ºã—ï¼ˆh1ã‚¿ã‚°ï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ«
        ----------------------------------------------------------------------
        */
        h1 {
            color: #333;                          /* æ–‡å­—è‰²ï¼ˆæ¿ƒã„ã‚°ãƒ¬ãƒ¼ï¼‰ */
            border-bottom: 3px solid #4a90d9;     /* ä¸‹ç·šï¼ˆé’è‰²ã€3pxå¤ªã•ï¼‰ */
            padding-bottom: 10px;                 /* ä¸‹ç·šã¨ã®é–“éš” */
        }

        /*
        ----------------------------------------------------------------------
          ã‚³ãƒ³ãƒ†ãƒŠï¼ˆç™½ã„ç®±ï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ«
          .container ã¯ã€Œclass="container"ã€ã‚’æŒã¤è¦ç´ ã«é©ç”¨
        ----------------------------------------------------------------------
        */
        .container {
            background: white;                    /* èƒŒæ™¯ã‚’ç™½ã« */
            padding: 20px;                        /* å†…å´ã®ä½™ç™½ */
            border-radius: 8px;                   /* è§’ã‚’ä¸¸ãã™ã‚‹ */
            /* box-shadow: å½±ã‚’ã¤ã‘ã‚‹ï¼ˆæ¨ª, ç¸¦, ã¼ã‹ã—, è‰²ï¼‰ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;                  /* ä¸‹ã®è¦ç´ ã¨ã®é–“éš” */
        }

        /*
        ----------------------------------------------------------------------
          ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹å ´æ‰€ï¼‰
        ----------------------------------------------------------------------
        */
        .drop-zone {
            border: 3px dashed #4a90d9;           /* ç‚¹ç·šã®æ ï¼ˆé’è‰²ï¼‰ */
            border-radius: 8px;                   /* è§’ã‚’ä¸¸ã */
            padding: 40px;                        /* å†…å´ã®ä½™ç™½ï¼ˆå¤§ãã‚ï¼‰ */
            text-align: center;                   /* ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸­å¤®å¯„ã› */
            cursor: pointer;                      /* ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ‰‹ã®å½¢ã« */
            /* transition: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœï¼ˆ0.3ç§’ã‹ã‘ã¦å¤‰åŒ–ï¼‰ */
            transition: all 0.3s;
            background-color: #f8fafc;            /* è–„ã„ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ */
        }

        /*
         * :hover ã¯ã€ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸã¨ãã®ã‚¹ã‚¿ã‚¤ãƒ«
         * ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°ã®ã‚»ãƒ¬ã‚¯ã‚¿ã‚’æŒ‡å®šå¯èƒ½
         */
        .drop-zone:hover, .drop-zone.dragover {
            background-color: #e3f2fd;            /* é’ã¿ãŒã‹ã£ãŸèƒŒæ™¯ã«å¤‰åŒ– */
            border-color: #1976d2;                /* æ ç·šã‚’æ¿ƒã„é’ã« */
        }

        /* ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³å†…ã®æ®µè½ */
        .drop-zone p {
            margin: 0;                            /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒãƒ¼ã‚¸ãƒ³ã‚’å‰Šé™¤ */
            font-size: 16px;
            color: #666;                          /* ã‚°ãƒ¬ãƒ¼ã®æ–‡å­—è‰² */
        }

        /* ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³å†…ã®ã‚¢ã‚¤ã‚³ãƒ³ */
        .drop-zone .icon {
            font-size: 48px;                      /* å¤§ããªçµµæ–‡å­—ã‚µã‚¤ã‚º */
            margin-bottom: 10px;
        }

        /*
        ----------------------------------------------------------------------
          ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ï¼ˆéè¡¨ç¤ºï¼‰
          å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã¯ã€ã“ã®inputã‚’JavaScriptã§æ“ä½œã—ã¦è¡Œã„ã¾ã™
        ----------------------------------------------------------------------
        */
        input[type="file"] {
            display: none;                        /* ç”»é¢ã«è¡¨ç¤ºã—ãªã„ */
        }

        /*
        ----------------------------------------------------------------------
          ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±è¡¨ç¤ºã‚¨ãƒªã‚¢
        ----------------------------------------------------------------------
        */
        .file-info {
            margin-top: 15px;
            padding: 10px;
            background: #e8f5e9;                  /* è–„ã„ç·‘ã®èƒŒæ™¯ï¼ˆæˆåŠŸã‚’ç¤ºã™è‰²ï¼‰ */
            border-radius: 4px;
            display: none;                        /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
        }

        /* .show ã‚¯ãƒ©ã‚¹ãŒè¿½åŠ ã•ã‚ŒãŸã¨ãã«è¡¨ç¤º */
        .file-info.show {
            display: block;                       /* ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ã¨ã—ã¦è¡¨ç¤º */
        }

        /*
        ----------------------------------------------------------------------
          ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«
        ----------------------------------------------------------------------
        */
        button {
            background-color: #4a90d9;            /* é’ã„èƒŒæ™¯ */
            color: white;                         /* ç™½ã„æ–‡å­— */
            border: none;                         /* æ ç·šãªã— */
            padding: 12px 24px;                   /* å†…å´ã®ä½™ç™½ï¼ˆä¸Šä¸‹12px, å·¦å³24pxï¼‰ */
            font-size: 16px;
            border-radius: 4px;                   /* å°‘ã—è§’ã‚’ä¸¸ã */
            cursor: pointer;                      /* æ‰‹ã®ã‚«ãƒ¼ã‚½ãƒ« */
            margin: 5px;
            transition: background-color 0.3s;    /* è‰²å¤‰åŒ–ã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        }

        /* ãƒœã‚¿ãƒ³ã«ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸã¨ã */
        button:hover {
            background-color: #357abd;            /* å°‘ã—æš—ã„é’ã« */
        }

        /* disabledå±æ€§ãŒã¤ã„ãŸãƒœã‚¿ãƒ³ï¼ˆç„¡åŠ¹åŒ–çŠ¶æ…‹ï¼‰ */
        button:disabled {
            background-color: #ccc;               /* ã‚°ãƒ¬ãƒ¼ã« */
            cursor: not-allowed;                  /* ç¦æ­¢ã‚«ãƒ¼ã‚½ãƒ« */
        }

        /* ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ï¼ˆã‚°ãƒ¬ãƒ¼ç³»ï¼‰ */
        button.secondary {
            background-color: #6c757d;
        }

        button.secondary:hover {
            background-color: #545b62;
        }

        /* ãƒœã‚¿ãƒ³ã‚’ã¾ã¨ã‚ã‚‹ã‚°ãƒ«ãƒ¼ãƒ— */
        .button-group {
            margin-top: 15px;
        }

        /*
        ----------------------------------------------------------------------
          ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆè¡¨ï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ«
        ----------------------------------------------------------------------
        */
        table {
            width: 100%;                          /* è¦ªè¦ç´ ã®å¹…ã„ã£ã±ã„ã« */
            border-collapse: collapse;            /* ã‚»ãƒ«é–“ã®éš™é–“ã‚’ãªãã™ */
            margin-top: 15px;
            font-size: 14px;
        }

        /* thï¼ˆè¦‹å‡ºã—ã‚»ãƒ«ï¼‰ã¨ tdï¼ˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ï¼‰ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
        th, td {
            border: 1px solid #ddd;               /* è–„ã„ã‚°ãƒ¬ãƒ¼ã®æ ç·š */
            padding: 10px 8px;                    /* å†…å´ã®ä½™ç™½ */
            text-align: left;                     /* å·¦å¯„ã› */
        }

        /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆè¦‹å‡ºã—è¡Œï¼‰ */
        th {
            background-color: #4a90d9;            /* é’ã„èƒŒæ™¯ */
            color: white;                         /* ç™½ã„æ–‡å­— */
            position: sticky;                     /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚‚å›ºå®šè¡¨ç¤º */
            top: 0;                               /* ä¸Šç«¯ã«å›ºå®š */
        }

        /*
         * nth-child(even): å¶æ•°ç•ªç›®ã®è¦ç´ ã‚’é¸æŠ
         * ã“ã‚Œã«ã‚ˆã‚Šã€è¡Œã”ã¨ã«äº¤äº’ã«èƒŒæ™¯è‰²ã‚’å¤‰ãˆã‚‹ï¼ˆç¸æ¨¡æ§˜ï¼‰
         */
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* è¡Œã«ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸã¨ãã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
        tr:hover {
            background-color: #f0f7ff;
        }

        /*
        ----------------------------------------------------------------------
          åˆ¤å®šçµæœã®ã‚»ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
        ----------------------------------------------------------------------
        */
        /* OKåˆ¤å®šï¼ˆç·‘ç³»ï¼‰ */
        .status-ok {
            background-color: #c6efce !important; /* !important ã§ä»–ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã */
            color: #006100;                       /* æ¿ƒã„ç·‘ã®æ–‡å­— */
            font-weight: bold;                    /* å¤ªå­— */
        }

        /* ç¢ºèªè¦åˆ¤å®šï¼ˆé»„è‰²ç³»ï¼‰ */
        .status-warning {
            background-color: #ffeb9c !important;
            color: #9c5700;                       /* èŒ¶è‰²ã£ã½ã„æ–‡å­— */
            font-weight: bold;
        }

        /*
        ----------------------------------------------------------------------
          çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰
        ----------------------------------------------------------------------
        */
        .result-container {
            max-height: 600px;                    /* æœ€å¤§é«˜ã•ã‚’åˆ¶é™ */
            overflow-y: auto;                     /* ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ‰åŠ¹ã« */
        }

        /*
        ----------------------------------------------------------------------
          ã‚µãƒãƒªãƒ¼ï¼ˆé›†è¨ˆæƒ…å ±ï¼‰è¡¨ç¤º
        ----------------------------------------------------------------------
        */
        .summary {
            background: #e3f2fd;                  /* è–„ã„é’ã®èƒŒæ™¯ */
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .summary span {
            margin-right: 20px;                   /* é …ç›®é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
        }

        /*
        ----------------------------------------------------------------------
          ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
        ----------------------------------------------------------------------
        */
        .error {
            background: #ffebee;                  /* è–„ã„èµ¤ã®èƒŒæ™¯ */
            color: #c62828;                       /* èµ¤ã„æ–‡å­— */
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
        }

        /*
        ----------------------------------------------------------------------
          ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
        ----------------------------------------------------------------------
        */
        .loading {
            text-align: center;
            padding: 20px;
        }

        /*
         * ::after ã¯ç–‘ä¼¼è¦ç´ ï¼ˆè¦ç´ ã®å¾Œã‚ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¿½åŠ ï¼‰
         * ã“ã“ã§ã¯ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã‚’ä½œæˆ
         */
        .loading::after {
            content: '';                          /* ç©ºã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #4a90d9;            /* é’ã„å†† */
            border-radius: 50%;                   /* å®Œå…¨ãªå††å½¢ã« */
            border-top-color: transparent;        /* ä¸Šéƒ¨ã‚’é€æ˜ã«ï¼ˆå›è»¢åŠ¹æœã®ãŸã‚ï¼‰ */
            animation: spin 1s linear infinite;   /* spinã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’1ç§’ã§ç„¡é™ãƒ«ãƒ¼ãƒ— */
            margin-left: 10px;
            vertical-align: middle;               /* ç¸¦æ–¹å‘ä¸­å¤®æƒãˆ */
        }

        /*
         * @keyframes: CSSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©
         * ã€Œspinã€ã¨ã„ã†åå‰ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
         * 0%ã‹ã‚‰100%ã¾ã§360åº¦å›è»¢ã™ã‚‹
         */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /*
        ----------------------------------------------------------------------
          ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ï¼ˆæ±ç”¨çš„ãªã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
        ----------------------------------------------------------------------
        */
        /* è¦ç´ ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
        .hidden {
            display: none;
        }

        /* éšå±¤ã‚’ç¤ºã™ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆã‚°ãƒ¬ãƒ¼ã®ç©ºç™½ï¼‰ */
        .level-indent {
            color: #999;
        }

        /*
        ----------------------------------------------------------------------
          ãƒ•ãƒƒã‚¿ãƒ¼
        ----------------------------------------------------------------------
        */
        footer {
            text-align: center;
            color: #666;
            font-size: 12px;
            margin-top: 30px;
        }
    </style>
</head>

<body>
    <!--
    ==========================================================================
      <body>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ - ãƒšãƒ¼ã‚¸ã®å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„

      ã€HTMLã‚¿ã‚°ã®åŸºæœ¬ã€‘
      <ã‚¿ã‚°å å±æ€§="å€¤">å†…å®¹</ã‚¿ã‚°å>

      ä¾‹: <div class="container">Hello</div>
          â†’ divã‚¿ã‚°ã«containerã‚¯ãƒ©ã‚¹ã‚’ä»˜ä¸ã€ä¸­èº«ã¯ã€ŒHelloã€

      ã€ã‚ˆãä½¿ã†ã‚¿ã‚°ã€‘
      <div>  : ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ï¼ˆç®±ï¼‰ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç”¨
      <span> : ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³è¦ç´ ã€ãƒ†ã‚­ã‚¹ãƒˆã®ä¸€éƒ¨ã‚’è£…é£¾
      <h1>~<h6> : è¦‹å‡ºã—ï¼ˆh1ãŒæœ€ã‚‚å¤§ãã„ï¼‰
      <p>    : æ®µè½
      <button> : ãƒœã‚¿ãƒ³
      <table>, <tr>, <th>, <td> : ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆè¡¨ï¼‰
    ==========================================================================
    -->

    <!-- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ« -->
    <h1>PDF ã—ãŠã‚Šæ¤œè¨¼ãƒ„ãƒ¼ãƒ«</h1>

    <!--
    ========================================
      ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³
    ========================================
    -->
    <div class="container">
        <h2>PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</h2>

        <!--
        ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³
        id="dropZone" : JavaScriptã‹ã‚‰ã“ã®è¦ç´ ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ID
        -->
        <div class="drop-zone" id="dropZone">
            <div class="icon">ğŸ“„</div>
            <!--
            <br>ã‚¿ã‚°: æ”¹è¡Œ
            -->
            <p>ã“ã“ã«PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—<br>ã¾ãŸã¯ ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</p>
        </div>

        <!--
        ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ï¼ˆéè¡¨ç¤ºï¼‰
        type="file" : ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠç”¨ã®å…¥åŠ›
        accept=".pdf" : PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿é¸æŠå¯èƒ½
        -->
        <input type="file" id="fileInput" accept=".pdf">

        <!-- é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒªã‚¢ -->
        <div class="file-info" id="fileInfo"></div>

        <!--
        ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—
        disabledå±æ€§: ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ããªã„çŠ¶æ…‹ï¼‰
        -->
        <div class="button-group">
            <button id="validateBtn" disabled>ã—ãŠã‚Šæ¤œè¨¼</button>
            <button id="clearBtn" class="secondary" disabled>ã‚¯ãƒªã‚¢</button>
        </div>
    </div>

    <!--
    ========================================
      æ¤œè¨¼çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤ºï¼‰
    ========================================
    -->
    <div class="container hidden" id="resultContainer">
        <h2>æ¤œè¨¼çµæœ</h2>

        <!-- ã‚µãƒãƒªãƒ¼ï¼ˆé›†è¨ˆæƒ…å ±ï¼‰è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div class="summary" id="summary"></div>

        <div class="button-group">
            <button id="csvBtn">CSVå‡ºåŠ›</button>
        </div>

        <!--
        ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆè¡¨ï¼‰
        <table> : ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“
          <thead> : ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†
            <tr> : è¡Œï¼ˆtable rowï¼‰
              <th> : ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ãƒ«ï¼ˆtable headerï¼‰
          <tbody> : ãƒ‡ãƒ¼ã‚¿éƒ¨åˆ†
            <tr> : è¡Œ
              <td> : ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ï¼ˆtable dataï¼‰
        -->
        <div class="result-container">
            <table id="resultTable">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>ã—ãŠã‚Šå</th>
                        <th>éšå±¤</th>
                        <th>ãƒªãƒ³ã‚¯å…ˆãƒšãƒ¼ã‚¸</th>
                        <th>åˆ¤å®š</th>
                    </tr>
                </thead>
                <!-- tbodyã®ä¸­èº«ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                <tbody id="resultBody"></tbody>
            </table>
        </div>
    </div>

    <!--
    ========================================
      ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤ºï¼‰
    ========================================
    -->
    <div class="container hidden" id="errorContainer">
        <div class="error" id="errorMessage"></div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer>
        PDF ã—ãŠã‚Šæ¤œè¨¼ãƒ„ãƒ¼ãƒ« - å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸è¦ãƒ»ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œ
    </footer>

    <!--
    ==========================================================================
      <script>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ - JavaScriptï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰

      ã€JavaScriptã®åŸºæœ¬ã€‘
      ãƒ»å¤‰æ•°å®£è¨€: letï¼ˆå¤‰æ›´å¯èƒ½ï¼‰, constï¼ˆå¤‰æ›´ä¸å¯ï¼‰
      ãƒ»é–¢æ•°å®šç¾©: function åå‰() { å‡¦ç† }
      ãƒ»ã‚¢ãƒ­ãƒ¼é–¢æ•°: (å¼•æ•°) => { å‡¦ç† }  â€»çœç•¥å½¢ã®é–¢æ•°è¨˜æ³•
      ãƒ»DOMæ“ä½œ: HTMLè¦ç´ ã‚’JavaScriptã§æ“ä½œã™ã‚‹
      ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œï¼ˆã‚¯ãƒªãƒƒã‚¯ã€ãƒ‰ãƒ©ãƒƒã‚°ãªã©ï¼‰ã‚’æ¤œçŸ¥
    ==========================================================================
    -->
    <script>
        /*
        ======================================================================
          ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
          ãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¨ä½“ã§ä½¿ã†å¤‰æ•°ã‚’å®šç¾©
        ======================================================================
        */

        // let: å¾Œã‹ã‚‰å€¤ã‚’å¤‰æ›´ã§ãã‚‹å¤‰æ•°
        // null: ã€Œä½•ã‚‚ãªã„ã€ã¨ã„ã†æ„å‘³ã®ç‰¹åˆ¥ãªå€¤
        let selectedFile = null;  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ãŸPDFãƒ•ã‚¡ã‚¤ãƒ«
        let bookmarks = [];       // æŠ½å‡ºã—ãŸã—ãŠã‚Šæƒ…å ±ã‚’æ ¼ç´ã™ã‚‹é…åˆ—

        /*
        ======================================================================
          DOMè¦ç´ ã®å–å¾—

          document.getElementById('IDå')
          â†’ HTMLã®ä¸­ã‹ã‚‰ã€æŒ‡å®šã—ãŸIDã‚’æŒã¤è¦ç´ ã‚’å–å¾—ã—ã¾ã™

          const: å¤‰æ›´ä¸å¯ã®å¤‰æ•°ï¼ˆå†ä»£å…¥ç¦æ­¢ï¼‰
          å–å¾—ã—ãŸè¦ç´ è‡ªä½“ã¯å¤‰æ›´ã—ãªã„ã®ã§constã‚’ä½¿ç”¨
        ======================================================================
        */
        const dropZone = document.getElementById('dropZone');         // ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³
        const fileInput = document.getElementById('fileInput');       // ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›
        const fileInfo = document.getElementById('fileInfo');         // ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±è¡¨ç¤º
        const validateBtn = document.getElementById('validateBtn');   // æ¤œè¨¼ãƒœã‚¿ãƒ³
        const clearBtn = document.getElementById('clearBtn');         // ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³
        const csvBtn = document.getElementById('csvBtn');             // CSVå‡ºåŠ›ãƒœã‚¿ãƒ³
        const resultContainer = document.getElementById('resultContainer');  // çµæœã‚³ãƒ³ãƒ†ãƒŠ
        const resultBody = document.getElementById('resultBody');     // çµæœãƒ†ãƒ¼ãƒ–ãƒ«ã®body
        const summary = document.getElementById('summary');           // ã‚µãƒãƒªãƒ¼
        const errorContainer = document.getElementById('errorContainer');    // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ
        const errorMessage = document.getElementById('errorMessage'); // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

        /*
        ======================================================================
          ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š

          è¦ç´ .addEventListener('ã‚¤ãƒ™ãƒ³ãƒˆå', å®Ÿè¡Œã™ã‚‹é–¢æ•°)
          â†’ æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«ã€é–¢æ•°ã‚’å®Ÿè¡Œã—ã¾ã™

          ã€ä¸»ãªã‚¤ãƒ™ãƒ³ãƒˆã€‘
          'click'     : ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ã
          'change'    : å€¤ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ã
          'dragover'  : è¦ç´ ã®ä¸Šã«ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ã¨ã
          'dragleave' : ãƒ‰ãƒ©ãƒƒã‚°ãŒè¦ç´ ã‹ã‚‰é›¢ã‚ŒãŸã¨ã
          'drop'      : ãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸã¨ã
        ======================================================================
        */

        /*
        ----------------------------------------------------------------------
          ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
          ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰ã€éš ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆç™ºç«ï¼‰ã•ã›ã‚‹
        ----------------------------------------------------------------------
        */
        // () => {} ã¯ã‚¢ãƒ­ãƒ¼é–¢æ•°ï¼ˆç„¡åé–¢æ•°ã®çœç•¥å½¢ï¼‰
        dropZone.addEventListener('click', () => fileInput.click());

        /*
        ----------------------------------------------------------------------
          ãƒ‰ãƒ©ãƒƒã‚°ã‚ªãƒ¼ãƒãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ä¸Šã«ä¹—ã›ã¦ã„ã‚‹ã¨ãï¼‰
        ----------------------------------------------------------------------
        */
        dropZone.addEventListener('dragover', (e) => {
            // e.preventDefault(): ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã‚’ç„¡åŠ¹åŒ–
            // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚’è‡ªåˆ†ã§å‡¦ç†ã™ã‚‹ãŸã‚ã«å¿…è¦
            e.preventDefault();

            // classList.add(): ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
            // 'dragover'ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã¦ã€CSSã§ã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´
            dropZone.classList.add('dragover');
        });

        /*
        ----------------------------------------------------------------------
          ãƒ‰ãƒ©ãƒƒã‚°ãƒªãƒ¼ãƒ–ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ‰ãƒ©ãƒƒã‚°ãŒè¦ç´ ã‹ã‚‰é›¢ã‚ŒãŸã¨ãï¼‰
        ----------------------------------------------------------------------
        */
        dropZone.addEventListener('dragleave', () => {
            // classList.remove(): ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            dropZone.classList.remove('dragover');
        });

        /*
        ----------------------------------------------------------------------
          ãƒ‰ãƒ­ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸã¨ãï¼‰
        ----------------------------------------------------------------------
        */
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã‚’ç„¡åŠ¹åŒ–
            dropZone.classList.remove('dragover');

            // e.dataTransfer.files: ãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§
            const files = e.dataTransfer.files;

            // ãƒ•ã‚¡ã‚¤ãƒ«ãŒ1ã¤ä»¥ä¸Šã‚ã‚Šã€PDFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
            if (files.length > 0 && files[0].type === 'application/pdf') {
                handleFile(files[0]);  // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†é–¢æ•°ã‚’å‘¼ã³å‡ºã—
            } else {
                showError('PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
            }
        });

        /*
        ----------------------------------------------------------------------
          ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã®changeã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚ŒãŸã¨ãï¼‰
        ----------------------------------------------------------------------
        */
        fileInput.addEventListener('change', (e) => {
            // e.target: ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸè¦ç´ ï¼ˆfileInputè‡ªèº«ï¼‰
            // e.target.files: é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        /*
        ======================================================================
          ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†

          function é–¢æ•°å(å¼•æ•°) { å‡¦ç† }
          â†’ é–¢æ•°ã®å®šç¾©ã€‚å‘¼ã³å‡ºã™ã¾ã§å®Ÿè¡Œã•ã‚Œãªã„
        ======================================================================
        */
        function handleFile(file) {
            // é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜
            selectedFile = file;

            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«: ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆ(``)ã§å›²ã‚€
            // ${å¤‰æ•°å} ã§å¤‰æ•°ã®å€¤ã‚’åŸ‹ã‚è¾¼ã‚ã‚‹
            fileInfo.innerHTML = `<strong>é¸æŠãƒ•ã‚¡ã‚¤ãƒ«:</strong> ${file.name} (${formatFileSize(file.size)})`;

            // ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã¦è¡¨ç¤ºçŠ¶æ…‹ã«
            fileInfo.classList.add('show');

            // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–ï¼ˆdisabledå±æ€§ã‚’è§£é™¤ï¼‰
            validateBtn.disabled = false;
            clearBtn.disabled = false;

            // ã‚¨ãƒ©ãƒ¼ã¨çµæœã‚’éè¡¨ç¤ºã«
            hideError();
            resultContainer.classList.add('hidden');
        }

        /*
        ======================================================================
          ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆèª­ã¿ã‚„ã™ã„å½¢å¼ã«å¤‰æ›ï¼‰

          ä¾‹: 1024 â†’ "1.0 KB"
              1048576 â†’ "1.0 MB"
        ======================================================================
        */
        function formatFileSize(bytes) {
            // æ¡ä»¶åˆ†å²: if (æ¡ä»¶) { å‡¦ç† }
            // return: é–¢æ•°ã®çµæœã‚’è¿”ã—ã¦çµ‚äº†
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            // toFixed(1): å°æ•°ç‚¹ä»¥ä¸‹1æ¡ã«ä¸¸ã‚ã‚‹
        }

        /*
        ======================================================================
          æ¤œè¨¼ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ

          async/await: éåŒæœŸå‡¦ç†ã‚’åŒæœŸçš„ã«æ›¸ã‘ã‚‹æ§‹æ–‡
          â†’ ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ãªã©ã€æ™‚é–“ãŒã‹ã‹ã‚‹å‡¦ç†ã§ä½¿ç”¨
        ======================================================================
        */
        validateBtn.addEventListener('click', async () => {
            // ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ãªã‘ã‚Œã°ä½•ã‚‚ã—ãªã„
            if (!selectedFile) return;

            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’ã€Œè§£æä¸­...ã€ã«
            validateBtn.disabled = true;
            validateBtn.innerHTML = 'è§£æä¸­...';
            hideError();

            // try-catch: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å‡¦ç†ã‚’å›²ã‚€
            // ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸã‚‰catchãƒ–ãƒ­ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹
            try {
                // await: å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…æ©Ÿ
                // arrayBuffer(): ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦èª­ã¿è¾¼ã‚€
                const arrayBuffer = await selectedFile.arrayBuffer();

                // PDFè§£æã‚’å®Ÿè¡Œ
                bookmarks = parsePDFBookmarks(arrayBuffer);

                // çµæœã‚’è¡¨ç¤º
                displayResults();
            } catch (error) {
                // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ
                showError(error.message);
            } finally {
                // finally: æˆåŠŸãƒ»å¤±æ•—ã«é–¢ã‚ã‚‰ãšæœ€å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹
                validateBtn.disabled = false;
                validateBtn.innerHTML = 'ã—ãŠã‚Šæ¤œè¨¼';
            }
        });

        /*
        ======================================================================
          ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
        ======================================================================
        */
        clearBtn.addEventListener('click', () => {
            // ã™ã¹ã¦ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            selectedFile = null;
            bookmarks = [];
            fileInput.value = '';  // ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã‚’ã‚¯ãƒªã‚¢
            fileInfo.classList.remove('show');
            validateBtn.disabled = true;
            clearBtn.disabled = true;
            resultContainer.classList.add('hidden');
            hideError();
        });

        /*
        ======================================================================
          CSVå‡ºåŠ›ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ

          CSVãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        ======================================================================
        */
        csvBtn.addEventListener('click', () => {
            // ã—ãŠã‚ŠãŒãªã‘ã‚Œã°ä½•ã‚‚ã—ãªã„
            if (bookmarks.length === 0) return;

            // BOMï¼ˆByte Order Markï¼‰: Excelã§é–‹ã„ãŸã¨ãã«æ–‡å­—åŒ–ã‘ã‚’é˜²ã
            let csv = '\uFEFF';
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
            csv += 'No,ã—ãŠã‚Šå,éšå±¤,ãƒªãƒ³ã‚¯å…ˆãƒšãƒ¼ã‚¸,åˆ¤å®š\n';

            // forEach: é…åˆ—ã®å„è¦ç´ ã«å¯¾ã—ã¦å‡¦ç†ã‚’å®Ÿè¡Œ
            // bm: å„ã—ãŠã‚Šã€i: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0ã‹ã‚‰å§‹ã¾ã‚‹ç•ªå·ï¼‰
            bookmarks.forEach((bm, i) => {
                // ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆ""ã«å¤‰æ›ï¼‰
                const title = bm.title.replace(/"/g, '""');
                // ä¸‰é …æ¼”ç®—å­: æ¡ä»¶ ? çœŸã®å ´åˆ : å½ã®å ´åˆ
                const status = bm.page ? 'OK' : 'ç¢ºèªè¦';
                // CSVã®1è¡Œã‚’è¿½åŠ 
                csv += `${i + 1},"${title}",${bm.level},${bm.page || ''},${status}\n`;
            });

            // Blob: ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' });

            // URL.createObjectURL: Blobã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLã‚’ç”Ÿæˆ
            const url = URL.createObjectURL(blob);

            // ä»®æƒ³çš„ãªãƒªãƒ³ã‚¯è¦ç´ ã‚’ä½œæˆã—ã¦ã‚¯ãƒªãƒƒã‚¯ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰
            const a = document.createElement('a');
            a.href = url;
            a.download = `ã—ãŠã‚Šæ¤œè¨¼çµæœ_${formatDate(new Date())}.csv`;
            a.click();

            // ä½¿ç”¨æ¸ˆã¿ã®URLã‚’è§£æ”¾ï¼ˆãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰
            URL.revokeObjectURL(url);
        });

        /*
        ======================================================================
          æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°
          Date ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ "yyyymmdd_hhmm" å½¢å¼ã®æ–‡å­—åˆ—ã«å¤‰æ›
        ======================================================================
        */
        function formatDate(date) {
            const y = date.getFullYear();                           // å¹´ï¼ˆ4æ¡ï¼‰
            const m = String(date.getMonth() + 1).padStart(2, '0'); // æœˆï¼ˆ01-12ï¼‰
            const d = String(date.getDate()).padStart(2, '0');      // æ—¥ï¼ˆ01-31ï¼‰
            const h = String(date.getHours()).padStart(2, '0');     // æ™‚ï¼ˆ00-23ï¼‰
            const min = String(date.getMinutes()).padStart(2, '0'); // åˆ†ï¼ˆ00-59ï¼‰
            // padStart(2, '0'): 2æ¡ã«ãªã‚‹ã‚ˆã†ã«å·¦å´ã‚’'0'ã§åŸ‹ã‚ã‚‹
            return `${y}${m}${d}_${h}${min}`;
        }

        /*
        ======================================================================
          ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºé–¢æ•°
        ======================================================================
        */
        function showError(message) {
            // textContent: è¦ç´ ã®ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã‚’è¨­å®š
            errorMessage.textContent = message;
            errorContainer.classList.remove('hidden');  // è¡¨ç¤º
            resultContainer.classList.add('hidden');    // çµæœã¯éè¡¨ç¤º
        }

        function hideError() {
            errorContainer.classList.add('hidden');
        }

        /*
        ======================================================================
          çµæœè¡¨ç¤ºé–¢æ•°
          æŠ½å‡ºã—ãŸã—ãŠã‚Šæƒ…å ±ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡¨ç¤º
        ======================================================================
        */
        function displayResults() {
            // ã—ãŠã‚ŠãŒãªã‘ã‚Œã°ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
            if (bookmarks.length === 0) {
                showError('ã“ã®PDFã«ã¯ã—ãŠã‚ŠãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
                return;
            }

            // filter: æ¡ä»¶ã«åˆã†è¦ç´ ã ã‘ã‚’æŠ½å‡º
            // b => b.page ã¯ b.page ãŒçœŸï¼ˆå€¤ãŒã‚ã‚‹ï¼‰ãªã‚‰ true
            const okCount = bookmarks.filter(b => b.page).length;
            const warningCount = bookmarks.length - okCount;

            // ã‚µãƒãƒªãƒ¼ã‚’æ›´æ–°ï¼ˆinnerHTML: HTMLæ–‡å­—åˆ—ã‚’è¨­å®šï¼‰
            summary.innerHTML = `
                <span><strong>ç·ã—ãŠã‚Šæ•°:</strong> ${bookmarks.length}</span>
                <span style="color: #006100;"><strong>OK:</strong> ${okCount}</span>
                <span style="color: #9c5700;"><strong>ç¢ºèªè¦:</strong> ${warningCount}</span>
            `;

            // ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸­èº«ã‚’ã‚¯ãƒªã‚¢
            resultBody.innerHTML = '';

            // å„ã—ãŠã‚Šã«å¯¾ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã‚’ç”Ÿæˆ
            bookmarks.forEach((bm, i) => {
                // æ–°ã—ã„trè¦ç´ ã‚’ä½œæˆ
                const tr = document.createElement('tr');
                const status = bm.page ? 'OK' : 'ç¢ºèªè¦';
                const statusClass = bm.page ? 'status-ok' : 'status-warning';
                // repeat(): æ–‡å­—åˆ—ã‚’æŒ‡å®šå›æ•°ç¹°ã‚Šè¿”ã™ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆç”¨ï¼‰
                const indent = 'ã€€'.repeat(bm.level - 1);

                // trè¦ç´ ã®ä¸­èº«ï¼ˆã‚»ãƒ«ï¼‰ã‚’HTMLæ–‡å­—åˆ—ã§è¨­å®š
                tr.innerHTML = `
                    <td>${i + 1}</td>
                    <td><span class="level-indent">${indent}</span>${escapeHtml(bm.title)}</td>
                    <td>${bm.level}</td>
                    <td>${bm.page || '-'}</td>
                    <td class="${statusClass}">${status}</td>
                `;

                // ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡Œã‚’è¿½åŠ 
                resultBody.appendChild(tr);
            });

            // çµæœã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤º
            resultContainer.classList.remove('hidden');
        }

        /*
        ======================================================================
          HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é–¢æ•°

          ç‰¹æ®Šæ–‡å­—ï¼ˆ<, >, &ãªã©ï¼‰ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ã¦ã€
          HTMLã¨ã—ã¦è§£é‡ˆã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ï¼ˆXSSå¯¾ç­–ï¼‰
        ======================================================================
        */
        function escapeHtml(text) {
            // divè¦ç´ ã‚’ä¸€æ™‚çš„ã«ä½œæˆ
            const div = document.createElement('div');
            // textContentã«è¨­å®šã™ã‚‹ã¨è‡ªå‹•çš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã‚‹
            div.textContent = text;
            // innerHTMLã§å–å¾—ã™ã‚‹ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸæ–‡å­—åˆ—ãŒå¾—ã‚‰ã‚Œã‚‹
            return div.innerHTML;
        }

        /*
        ======================================================================
          PDFè§£æãƒ¡ã‚¤ãƒ³é–¢æ•°

          PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã—ãŠã‚Šæƒ…å ±ã‚’æŠ½å‡º
        ======================================================================
        */
        function parsePDFBookmarks(arrayBuffer) {
            // Uint8Array: ãƒã‚¤ãƒˆé…åˆ—ï¼ˆ0-255ã®æ•°å€¤ã®é…åˆ—ï¼‰
            const bytes = new Uint8Array(arrayBuffer);

            // ãƒã‚¤ãƒŠãƒªã‚’Latin-1æ–‡å­—åˆ—ã«å¤‰æ›ï¼ˆPDFå†…éƒ¨ã®æ¤œç´¢ç”¨ï¼‰
            const content = latin1Decode(bytes);

            // PDFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã©ã†ã‹ã‚’ç¢ºèª
            // startsWith(): æ–‡å­—åˆ—ãŒæŒ‡å®šã—ãŸæ–‡å­—åˆ—ã§å§‹ã¾ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            if (!content.startsWith('%PDF-')) {
                // throw: ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã‚‹
                throw new Error('æœ‰åŠ¹ãªPDFãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚');
            }

            // ã—ãŠã‚Šï¼ˆOutlinesï¼‰ã®å­˜åœ¨ç¢ºèª
            // match(): æ­£è¦è¡¨ç¾ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
            // \s: ç©ºç™½æ–‡å­—ã€\d: æ•°å­—
            if (!content.match(/\/Outlines\s+\d+\s+\d+\s+R/) && !content.match(/\/Type\s*\/Outlines/)) {
                throw new Error('ã“ã®PDFã«ã¯ã—ãŠã‚ŠãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
            }

            // ãƒšãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ãƒšãƒ¼ã‚¸ç•ªå·ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä½œæˆ
            const pageObjects = buildPageMapping(content);

            // ã—ãŠã‚Šæƒ…å ±ã‚’æŠ½å‡º
            const bookmarks = extractBookmarks(content, bytes, pageObjects);

            if (bookmarks.length === 0) {
                throw new Error('ã—ãŠã‚Šã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚PDFãŒæš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ã€ç‰¹æ®Šãªå½¢å¼ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
            }

            return bookmarks;
        }

        /*
        ======================================================================
          Latin-1ãƒ‡ã‚³ãƒ¼ãƒ‰é–¢æ•°

          ãƒã‚¤ãƒˆé…åˆ—ã‚’ Latin-1ï¼ˆISO-8859-1ï¼‰æ–‡å­—åˆ—ã«å¤‰æ›
          PDFã®å†…éƒ¨æ§‹é€ ã‚’æ–‡å­—åˆ—ã¨ã—ã¦æ¤œç´¢ã™ã‚‹ãŸã‚ã«ä½¿ç”¨
        ======================================================================
        */
        function latin1Decode(bytes) {
            let result = '';
            // foræ–‡: ç¹°ã‚Šè¿”ã—å‡¦ç†
            for (let i = 0; i < bytes.length; i++) {
                // String.fromCharCode(): æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æ–‡å­—ã‚’ç”Ÿæˆ
                result += String.fromCharCode(bytes[i]);
            }
            return result;
        }

        /*
        ======================================================================
          ãƒšãƒ¼ã‚¸ãƒãƒƒãƒ”ãƒ³ã‚°æ§‹ç¯‰é–¢æ•°

          PDFã®ãƒšãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç•ªå·ã¨å®Ÿéš›ã®ãƒšãƒ¼ã‚¸ç•ªå·ã®å¯¾å¿œè¡¨ã‚’ä½œæˆ
        ======================================================================
        */
        function buildPageMapping(content) {
            // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé€£æƒ³é…åˆ—ï¼‰: ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã‚’æ ¼ç´
            const pageObjects = {};

            // æ­£è¦è¡¨ç¾: /ãƒ‘ã‚¿ãƒ¼ãƒ³/ãƒ•ãƒ©ã‚°
            // g ãƒ•ãƒ©ã‚°: ã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼ˆã™ã¹ã¦ã®ãƒãƒƒãƒã‚’æ¤œç´¢ï¼‰
            // [\s\S]*?: ä»»æ„ã®æ–‡å­—ï¼ˆæœ€çŸ­ãƒãƒƒãƒï¼‰
            const pageObjPattern = /(\d+)\s+\d+\s+obj[\s\S]*?\/Type\s*\/Page[^s]/g;

            let match;
            let pageNum = 1;

            // exec(): æ­£è¦è¡¨ç¾ã§ãƒãƒƒãƒã‚’1ã¤ãšã¤å–å¾—ï¼ˆãƒ«ãƒ¼ãƒ—ã§å…¨å–å¾—ï¼‰
            while ((match = pageObjPattern.exec(content)) !== null) {
                const objNum = match[1];  // ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆæ‹¬å¼§å†…ï¼‰ã®å€¤
                pageObjects[objNum] = pageNum;
                pageNum++;
            }

            return pageObjects;
        }

        /*
        ======================================================================
          ã—ãŠã‚ŠæŠ½å‡ºé–¢æ•°

          PDFå†…ã®ã—ãŠã‚Šæƒ…å ±ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€ãƒšãƒ¼ã‚¸ç•ªå·ï¼‰ã‚’æŠ½å‡º
        ======================================================================
        */
        function extractBookmarks(content, bytes, pageObjects) {
            const bookmarks = [];

            /*
            --------------------------------------------------------------
              æ–¹æ³•1: ASCII/Latin-1ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ¤œç´¢
              /Title (ãƒ†ã‚­ã‚¹ãƒˆ) ã®å½¢å¼
            --------------------------------------------------------------
            */
            const titlePattern = /\/Title\s*\(([^)]*)\)/g;
            let match;

            while ((match = titlePattern.exec(content)) !== null) {
                let title = match[1];
                // PDFã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰
                title = decodePDFString(title);
                // push(): é…åˆ—ã«è¦ç´ ã‚’è¿½åŠ 
                bookmarks.push({ title, page: '', level: 1 });
            }

            /*
            --------------------------------------------------------------
              æ–¹æ³•2: UTF-16BEã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«ã‚’æ¤œç´¢
              /Title <FEFF0041...> ã®å½¢å¼ï¼ˆæ—¥æœ¬èªãªã©ï¼‰
              FEFF: UTF-16BEã®BOMï¼ˆãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼‰
            --------------------------------------------------------------
            */
            const hexPattern = /\/Title\s*<(FEFF[0-9A-Fa-f]+)>/g;
            while ((match = hexPattern.exec(content)) !== null) {
                // FEFFã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦å®Ÿéš›ã®æ–‡å­—ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const hexStr = match[1].substring(4);
                let title = '';
                // 4æ¡ãšã¤å‡¦ç†ï¼ˆUTF-16ã¯2ãƒã‚¤ãƒˆ=4æ¡ã®16é€²æ•°ï¼‰
                for (let i = 0; i < hexStr.length; i += 4) {
                    if (i + 4 <= hexStr.length) {
                        // parseInt(æ–‡å­—åˆ—, 16): 16é€²æ•°æ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›
                        const charCode = parseInt(hexStr.substring(i, i + 4), 16);
                        title += String.fromCharCode(charCode);
                    }
                }
                if (title) {
                    bookmarks.push({ title, page: '', level: 1 });
                }
            }

            /*
            --------------------------------------------------------------
              æ–¹æ³•3: é€šå¸¸ã®16é€²æ•°ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆLatin-1ï¼‰
              /Title <48656C6C6F> ã®å½¢å¼
            --------------------------------------------------------------
            */
            const hexPattern2 = /\/Title\s*<([0-9A-Fa-f]+)>/g;
            while ((match = hexPattern2.exec(content)) !== null) {
                // UTF-16BEã¯æ—¢ã«å‡¦ç†æ¸ˆã¿ãªã®ã§ã‚¹ã‚­ãƒƒãƒ—
                if (match[1].toUpperCase().startsWith('FEFF')) continue;
                const hexStr = match[1];
                let title = '';
                // 2æ¡ãšã¤å‡¦ç†ï¼ˆ1ãƒã‚¤ãƒˆ=2æ¡ã®16é€²æ•°ï¼‰
                for (let i = 0; i < hexStr.length; i += 2) {
                    if (i + 2 <= hexStr.length) {
                        const charCode = parseInt(hexStr.substring(i, i + 2), 16);
                        title += String.fromCharCode(charCode);
                    }
                }
                // trim(): å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
                if (title && title.trim()) {
                    bookmarks.push({ title, page: '', level: 1 });
                }
            }

            /*
            --------------------------------------------------------------
              ãƒšãƒ¼ã‚¸å‚ç…§ã‚’æ¤œç´¢ã—ã¦ã—ãŠã‚Šã«é–¢é€£ä»˜ã‘
              /Dest [ãƒšãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç•ªå· 0 R ...] ã®å½¢å¼
            --------------------------------------------------------------
            */
            const destPattern = /\/Dest\s*\[\s*(\d+)\s+\d+\s+R/g;
            const destinations = [];
            while ((match = destPattern.exec(content)) !== null) {
                destinations.push(match[1]);
            }

            // ã—ãŠã‚Šã«ãƒšãƒ¼ã‚¸ç•ªå·ã‚’å‰²ã‚Šå½“ã¦
            // Math.min(): å°ã•ã„æ–¹ã®å€¤ã‚’è¿”ã™
            for (let i = 0; i < Math.min(bookmarks.length, destinations.length); i++) {
                const pageRef = destinations[i];
                if (pageObjects[pageRef]) {
                    // ãƒãƒƒãƒ”ãƒ³ã‚°ã«ã‚ã‚Œã°ãƒšãƒ¼ã‚¸ç•ªå·ã‚’è¨­å®š
                    bookmarks[i].page = pageObjects[pageRef];
                } else {
                    // ãªã‘ã‚Œã°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç•ªå·ã‚’ãã®ã¾ã¾ä½¿ç”¨
                    bookmarks[i].page = parseInt(pageRef) || '';
                }
            }

            // éšå±¤æ§‹é€ ã®è§£æã‚’è©¦ã¿ã‚‹
            analyzeHierarchy(content, bookmarks);

            return bookmarks;
        }

        /*
        ======================================================================
          PDFã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹é–¢æ•°

          PDFæ–‡å­—åˆ—å†…ã®ç‰¹æ®Šæ–‡å­—ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰
          ä¾‹: \n â†’ æ”¹è¡Œã€\( â†’ (ã€\\123 â†’ 8é€²æ•°ã®æ–‡å­—
        ======================================================================
        */
        function decodePDFString(str) {
            // replace(æ­£è¦è¡¨ç¾, ç½®æ›æ–‡å­—åˆ—): æ–‡å­—åˆ—ç½®æ›
            return str
                .replace(/\\n/g, '\n')       // æ”¹è¡Œ
                .replace(/\\r/g, '\r')       // ã‚­ãƒ£ãƒªãƒƒã‚¸ãƒªã‚¿ãƒ¼ãƒ³
                .replace(/\\t/g, '\t')       // ã‚¿ãƒ–
                .replace(/\\\\/g, '\\')      // ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥
                .replace(/\\\(/g, '(')       // é–‹ãæ‹¬å¼§
                .replace(/\\\)/g, ')')       // é–‰ã˜æ‹¬å¼§
                // 8é€²æ•°ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—: \123 å½¢å¼
                .replace(/\\([0-7]{1,3})/g, (_, oct) => String.fromCharCode(parseInt(oct, 8)));
        }

        /*
        ======================================================================
          éšå±¤æ§‹é€ è§£æé–¢æ•°

          ã—ãŠã‚Šã®è¦ªå­é–¢ä¿‚ã‚’è§£æã—ã¦éšå±¤ãƒ¬ãƒ™ãƒ«ã‚’è¨­å®š
        ======================================================================
        */
        function analyzeHierarchy(content, bookmarks) {
            // ã—ãŠã‚Šã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŠ½å‡º
            // || []: ãƒãƒƒãƒãŒãªã‘ã‚Œã°ç©ºé…åˆ—ã‚’è¿”ã™
            const outlineItems = content.match(/\d+\s+\d+\s+obj[\s\S]*?\/Title[\s\S]*?endobj/g) || [];

            outlineItems.forEach((item, index) => {
                if (index < bookmarks.length) {
                    // /Parent ã¨ /First ã®å­˜åœ¨ã‚’ãƒã‚§ãƒƒã‚¯
                    const parentMatch = item.match(/\/Parent\s+(\d+)/);
                    const firstMatch = item.match(/\/First\s+(\d+)/);

                    // /Parent ãŒã‚ã‚Š /First ãŒãªã„ â†’ å­è¦ç´ ã®å¯èƒ½æ€§
                    if (parentMatch && !firstMatch) {
                        if (index > 0) {
                            // å‰ã®ã—ãŠã‚Šã‚ˆã‚Š1ãƒ¬ãƒ™ãƒ«æ·±ã
                            // Math.min(): æœ€å¤§5ãƒ¬ãƒ™ãƒ«ã«åˆ¶é™
                            bookmarks[index].level = Math.min(bookmarks[index - 1].level + 1, 5);
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
