# PDF しおり検証ツール (JavaScript版)

PDFのしおり（ブックマーク）がリンク先ページと正しく対応しているかを検証するWebベースのツールです。

## 概要

- **しおり一覧取得**: PDFからすべてのしおり（階層構造含む）を取得
- **ページ番号確認**: 各しおりのリンク先ページ番号を表示
- **外部ライブラリ不要**: 標準Web APIのみで動作
- **オフライン動作**: インターネット接続不要
- **クロスプラットフォーム**: Windows/Mac/Linux対応
- **CSV出力**: 検証結果をCSVファイルに出力可能

## 必要な環境

- モダンブラウザ（Chrome, Firefox, Edge, Safari）
- JavaScript有効

**追加インストール不要**: HTMLファイルをダブルクリックするだけで使用できます。

## 使い方

### 1. ツールを開く

`PDF_しおり検証ツール.html` をダブルクリックしてブラウザで開きます。

### 2. PDFファイルの選択

以下のいずれかの方法でPDFファイルを選択：
- ドロップゾーンにPDFファイルをドラッグ&ドロップ
- ドロップゾーンをクリックしてファイル選択ダイアログから選択

### 3. 検証実行

「しおり検証」ボタンをクリックすると、PDFを解析してしおり一覧を表示します。

### 4. 結果の確認

| 列 | 内容 |
|----|------|
| No | しおり番号 |
| しおり名 | しおりのタイトル（階層に応じてインデント） |
| 階層 | しおりの階層レベル（1が最上位） |
| リンク先ページ | しおりがリンクしているページ番号 |
| 判定 | OK/確認要 |

### 5. CSV出力（オプション）

「CSV出力」ボタンで結果をCSVファイルにダウンロードできます。

## 判定ロジック

| 判定 | 条件 |
|------|------|
| **OK** | ページ番号が取得できた |
| **確認要** | ページ番号が取得できない（Named destination等） |

## 技術仕様

### PDF解析方式

このツールは標準Web APIのみを使用してPDFを直接解析します：

- File APIでPDFをバイナリ読み込み
- 正規表現でしおり情報を抽出
- `/Title` タグからしおりタイトルを取得
- `/Dest` タグからリンク先ページ参照を取得
- UTF-16BE（日本語）エンコーディングに対応

### 対応PDFフォーマット

- 標準的なPDF 1.4〜1.7形式
- しおり（Outlines）が設定されているPDF
- 日本語タイトルのしおり

### 制限事項

- **暗号化PDF**: パスワード保護されたPDFは解析できません
- **圧縮しおり**: 一部の高度に圧縮されたPDFでは取得できない場合があります
- **ローカルファイルのみ**: セキュリティ上、ローカルファイルのみ対応

## トラブルシューティング

### エラー: 「有効なPDFファイルではありません」

→ ファイルがPDF形式であることを確認してください。

### エラー: 「このPDFにはしおりがありません」

→ PDFにしおり（ブックマーク）が設定されていません。Adobe Acrobat等でしおりを追加してください。

### しおりが取得できない

→ 以下の原因が考えられます：
- PDFが暗号化されている
- しおり情報が特殊な形式で格納されている
- PDFが破損している

### ファイルを選択できない

→ ブラウザのセキュリティ設定を確認してください。ローカルファイルへのアクセスが制限されている場合があります。

## ファイル構成

```
PDF_しおり検証ツール/
├── PDF_しおり検証ツール.html  # メインツール（これだけで動作）
└── README.md
```

## ライセンス

MIT License
