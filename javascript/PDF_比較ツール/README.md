# PDF 比較ツール

2つのPDFファイルを視覚的に比較するブラウザベースのツールです。

## 特徴

- **追加インストール不要** - HTMLファイルをダブルクリックするだけで起動
- **IT制限環境対応** - ブラウザがあれば動作
- **オフライン対応** - ローカル優先・CDNフォールバック方式
- **並列表示** - 2つのPDFを左右に並べて表示
- **全ページ一覧表示** - 全ページを縦に並べてスクロールで閲覧
- **差分ハイライト** - 違いを色で視覚的に表示（黄=変更、緑=追加、赤=削除）
- **ドラッグ&ドロップ** - パネルに直接PDFをドロップして読み込み
- **同期スクロール** - 左右のPDFが連動してスクロール
- **ズーム機能** - 50%〜200%の範囲で拡大・縮小
- **統計情報** - 変更・追加・削除ブロック数と差分率を表示

## 必要な環境

- モダンブラウザ（Chrome, Firefox, Edge, Safari）
- インターネット接続（オプション：ローカルにライブラリを配置すれば不要）

## 使い方

### 方法1: ドラッグ&ドロップ（推奨）

1. `PDFビジュアル比較ツール.html` をダブルクリックしてブラウザで開く
2. 左側のパネルに旧PDFをドラッグ&ドロップ
3. 右側のパネルに新PDFをドラッグ&ドロップ
4. 両方のPDFが読み込まれると自動的に比較開始
5. 全ページが縦に並んで表示され、差分が色付きでハイライト表示される

### 方法2: ファイル選択ボタン

1. `PDFビジュアル比較ツール.html` をダブルクリックしてブラウザで開く
2. ツールバーの「旧PDF」ボタンをクリックしてファイルを選択
3. ツールバーの「新PDF」ボタンをクリックしてファイルを選択
4. 「比較実行」ボタンをクリック

### 操作方法

- **ページ移動**: マウスホイールまたはスクロールバーで全ページを閲覧
- **ズーム**: ツールバーの倍率セレクトで50%〜200%の範囲で拡大・縮小
- **スクロール**: 左右のビューは同期してスクロール（チェックボックスで切替可能）
- **差分確認**: 色付きの領域が差異箇所

## 出力形式

### 画面表示

画面上部に統計情報を表示：
- **変更ブロック数**: 内容が変化した箇所
- **追加ブロック数**: 新ファイルに追加された箇所
- **削除ブロック数**: 旧ファイルから削除された箇所
- **差分率**: 全体に対する差分の割合（%）

### 色の凡例

- **黄色**: 内容の変更
- **緑色**: 新規追加
- **赤色**: 削除

## 技術仕様

### 使用ライブラリ

- **PDF.js** (Mozilla) - PDFをCanvasにレンダリング
  - バージョン: 3.11.174
  - ローカルパス: `lib/pdf.min.js` および `lib/pdf.worker.min.js`
  - CDN: `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js`

### ライブラリ読み込み方式

**ローカル優先・CDNフォールバック方式**を採用しています：

1. 最初に `lib/pdf.min.js` からローカル読み込みを試行
2. ローカルファイルがない場合、CDNから自動的に読み込み
3. 画面ヘッダーに読み込み元を表示（緑:ローカル、オレンジ:CDN）

### 差分検出アルゴリズム

ブロック単位（8x8ピクセル）でピクセルの差異を検出し、以下のように分類：
- 両方に内容がある場合 → 変更（黄色）
- 旧PDFのみに内容がある場合 → 削除（赤色）
- 新PDFのみに内容がある場合 → 追加（緑色）

## 制限事項

- **大きなPDF** - 高解像度のPDFは処理時間がかかる場合があります
- **メモリ使用量** - 複数ページのPDFを比較する場合、メモリ使用量が増加します

## オフライン使用（IT制限環境対応）

lib/フォルダにライブラリファイルが同梱されているため、オフライン環境でもそのまま動作します。

### フォルダ構成

```
PDF_比較ツール/
├── PDFビジュアル比較ツール.html ← 視覚比較ツール
├── README.md
└── lib/
    ├── pdf.min.js          ← PDF.jsライブラリ
    └── pdf.worker.min.js   ← PDF.jsワーカー
```

### 読み込み状態の確認

画面ヘッダーでライブラリの読み込み状態を確認できます：

| 表示 | 色 | 状態 |
|-----|---|-----|
| ライブラリ: ローカル | 緑 | lib/フォルダから読み込み成功 |
| ライブラリ: CDN（オンライン） | オレンジ | インターネットから読み込み |
| ライブラリ: 読み込み失敗 | 赤 | エラー（対処が必要） |

## トラブルシューティング

### 「PDFが読み込めない」

- PDFファイルが破損していないか確認してください
- 暗号化されたPDFは読み込めない場合があります

### 「比較が遅い」

- ブラウザのメモリが不足している場合は、他のタブを閉じてください
- ズームレベルを下げると処理が軽くなります

## ライセンス

MIT License

## 更新履歴

- **2025-12-17**: 全ページスクロール表示に変更
  - 全ページを縦に並べてスクロールで閲覧可能に
  - ページ切り替えボタンを廃止
  - ファイル名を日本語に変更（PDFビジュアル比較ツール.html）
  - 統計情報を全ページの累積に変更

- **2025-12-17**: ドラッグ&ドロップ機能追加
  - パネルに直接PDFをドロップして読み込み可能
  - 両方のPDFが読み込まれると自動で比較開始

- **2025-12-17**: 視覚比較ツール追加
  - PDFを左右に並べて視覚的に比較
  - ブロック単位の差分検出とカラーハイライト
  - 同期スクロール、ズーム機能
