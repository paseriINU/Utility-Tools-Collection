# PDF テキスト抽出ツール（WinMerge用）

PDFからテキストを抽出し、WinMergeで比較できるようにするツールです。

## 3つのバージョン

| ファイル | 説明 | WinMerge起動 | 必要な環境 |
|----------|------|-------------|-----------|
| `PDFテキスト抽出ツール.html` | ブラウザ版 | 手動 | ブラウザ |
| `PDFテキスト抽出_Word版.bat` | **Word版（推奨）** | **自動** | Word 2013以降 |
| `PDFテキスト抽出_WinMerge起動.hta` | HTA版 | 自動 | Windows（IE11ベース） |

## 特徴

- **追加インストール不要** - ファイルをダブルクリックするだけで起動
- **テキストベース比較** - 画像比較より正確な差分検出
- **WinMerge連携** - 抽出したテキストをWinMergeで比較
- **BOM付きUTF-8出力** - Windows環境で文字化けしない
- **ドラッグ&ドロップ** - PDFを直接ドロップして読み込み（HTML版）
- **プレビュー表示** - 抽出結果を画面上で確認可能

## 必要な環境

- モダンブラウザ（Chrome, Firefox, Edge, Safari）※HTML版
- Windows ※HTA版
- インターネット接続（PDF.jsをCDNから読み込み）
- WinMerge（テキスト比較用）

## 使い方

### Word版（推奨・WinMerge自動起動）

1. `PDFテキスト抽出_Word版.bat` をダブルクリック
2. ファイル選択ダイアログで旧PDFを選択
3. ファイル選択ダイアログで新PDFを選択
4. 自動的にテキスト抽出 → 一時ファイル保存 → WinMerge起動

**メリット**:
- 最も確実に動作
- WordでPDFを開くため、テキスト抽出精度が高い
- 追加インストール不要（Word 2013以降があれば動作）

### HTML版

1. `PDFテキスト抽出ツール.html` をダブルクリックしてブラウザで開く
2. 左側のパネルに旧PDFをドラッグ&ドロップ
3. 右側のパネルに新PDFをドラッグ&ドロップ
4. 「両方をダウンロード」ボタンをクリック
5. ダウンロードされた2つのテキストファイルをWinMergeで開く
6. テキストベースで正確な差分を確認

### HTA版（WinMerge自動起動）

1. `PDFテキスト抽出_WinMerge起動.hta` をダブルクリック
2. 2つのPDFファイルを選択
3. 「テキスト抽出してWinMergeで比較」ボタンをクリック
4. 自動的にテキスト抽出 → 一時ファイル保存 → WinMerge起動

**注意**: HTA版はIE11ベースのため、PDF.jsの動作が不安定な場合があります。その場合はWord版をご使用ください。

### 出力ファイル

- `[元のファイル名]_旧.txt` - 旧PDF（比較元）のテキスト
- `[元のファイル名]_新.txt` - 新PDF（比較先）のテキスト

## 既存のPDF比較ツールとの違い

| 項目 | PDF比較ツール（画像） | PDFテキスト抽出ツール |
|------|----------------------|---------------------|
| 比較方式 | ピクセル（画像）比較 | テキスト比較 |
| 精度 | レイアウト変更に敏感 | テキスト内容のみ比較 |
| 用途 | レイアウト確認 | 文字内容の差分確認 |
| 比較ツール | ブラウザ内で完結 | WinMerge使用 |

### 使い分け

- **PDF比較ツール（画像）**: レイアウトや画像の違いを視覚的に確認したい場合
- **PDFテキスト抽出ツール**: 文字内容の差分を正確に確認したい場合

## 技術仕様

### 使用ライブラリ

- **PDF.js** (Mozilla) - PDFからテキスト抽出
  - バージョン: 3.11.174
  - CDNから読み込み

### テキスト抽出方式

1. PDF.jsでPDFを解析
2. 各ページのテキストコンテンツを取得
3. Y座標の変化で改行を判定
4. ページ区切りを挿入して結合

## 制限事項

- **画像内テキスト** - 画像としてスキャンされたPDFはテキスト抽出不可
- **複雑なレイアウト** - 段組みや表の場合、テキスト順序が乱れる可能性あり
- **インターネット接続** - オフライン環境では動作しない（CDN依存）

## フォルダ構成

```
PDF_テキスト抽出ツール/
├── PDFテキスト抽出_Word版.bat        ← Word版（推奨・WinMerge自動起動）
├── PDFテキスト抽出ツール.html        ← ブラウザ版
├── PDFテキスト抽出_WinMerge起動.hta  ← HTA版
└── README.md
```

## トラブルシューティング

### 「PDF.jsが読み込めない」

- インターネット接続を確認してください
- ファイアウォールがCDNをブロックしていないか確認してください

### 「テキストが抽出されない」

- スキャンされた画像PDFの可能性があります
- OCR処理されたPDFでないとテキスト抽出できません

### 「文字化けする」

- BOM付きUTF-8で出力しているため、通常は文字化けしません
- 古いテキストエディタでは文字化けする可能性があります

## ライセンス

MIT License
