# Excel フィルター検索ツール

複数キーワードでOR条件のフィルター検索を行うVBAツールです。

## 機能

- ユーザーフォームで最大5つのキーワードを入力
- A列・B列に対してOR条件でフィルター適用
- 部分一致検索（ワイルドカード使用）
- フィルタークリア機能
- Enterキーで検索実行可能
- **フォームの自動作成機能**

## セットアップ手順

### 方法1: 自動セットアップ（推奨）

フォームを自動作成する方法です。

#### 1. VBAプロジェクトへのアクセスを許可

1. Excel → ファイル → オプション → トラストセンター → トラストセンターの設定
2. マクロの設定 → 「VBA プロジェクト オブジェクト モデルへのアクセスを信頼する」にチェック
3. OK → OK

#### 2. モジュールをインポート

1. `Alt + F11` でVBAエディタを開く
2. メニュー「ファイル」→「ファイルのインポート」
3. 以下のファイルをインポート:
   - `FSearch.bas`（メイン処理）
   - `FSearch_Setup.bas`（初期化モジュール）

#### 3. 初期化を実行

1. `Alt + F8` でマクロ一覧を表示
2. `InitializeFilterSearchTool` を実行
3. フォームが自動作成されます

### 方法2: 手動セットアップ

VBAプロジェクトへのアクセスが許可できない場合。

#### 1. モジュールをインポート

1. `Alt + F11` でVBAエディタを開く
2. `FSearch.bas` をインポート

#### 2. フォームを手動作成

1. メニュー「挿入」→「ユーザーフォーム」
2. プロパティで `(オブジェクト名)` を `FSearchForm` に変更

3. 以下のコントロールを配置:

   | コントロール | 名前 | Caption |
   |-------------|------|---------|
   | Label | lblTitle | 検索キーワード（OR条件） |
   | Label | lblWord1～5 | キーワード1:～5: |
   | TextBox | txtWord1～5 | （入力欄） |
   | CommandButton | btnSearch | 検索 |
   | CommandButton | btnClear | クリア |
   | CommandButton | btnClose | 閉じる |

4. `FSearchForm.frm` のコードをフォームに貼り付け

## 設定変更

`FSearch.bas` の定数を変更して対象シートや列を変更できます:

```vba
Private Const TARGET_SHEET_NAME As String = "テスト"    ' 対象シート名
Private Const FILTER_COLUMN_A As Long = 1               ' フィルター列1（A列=1）
Private Const FILTER_COLUMN_B As Long = 2               ' フィルター列2（B列=2）
```

## 使い方

1. `ShowFilterSearchForm` マクロを実行
2. フォームが表示される
3. キーワードを1つ以上入力
4. 「検索」ボタンをクリック（またはEnterキー）
5. フィルターが適用される

### クリア

「クリア」ボタンで:
- フィルターが解除
- 入力欄がクリア

## 注意事項

- 対象シートが存在しない場合はエラーメッセージが表示されます
- 3つ以上のキーワードを指定した場合は、AdvancedFilterを使用します
- マクロ有効ブック（.xlsm）として保存してください

## ファイル構成

```
Excel_フィルター検索ツール/
├── FSearch.bas         # 標準モジュール（メイン処理）
├── FSearch_Setup.bas   # 初期化モジュール（フォーム自動作成）
├── FSearchForm.frm     # ユーザーフォーム（手動作成時の参考）
└── README.md           # このファイル
```
