# Git 差分抽出ツール（VBA版）

Gitブランチ間/コミット間の差分ファイルを抽出し、Excelシートに履歴を残すVBAツールです。
バッチ版「Git_差分ファイル抽出ツール」のVBA版として、同等の機能を提供します。

## 機能

- Gitブランチ間の差分ファイル検出
- 差分ファイル一覧をExcelシートに出力（履歴として保存可能）
- 差分ファイルをフォルダ構成を維持して抽出
- 修正前/修正後のファイルを分けて出力

## 必要な環境

- Microsoft Excel 2010以降
- Git for Windows（コマンドラインから`git`が実行可能な状態）

## ファイル構成

```
Git_差分抽出ツール/
├── FDE_Config.bas   # 設定・定数定義
├── FDE_Main.bas     # メイン処理ロジック
├── FDE_Setup.bas    # シート初期化（初期化後は削除可能）
└── README.md        # このファイル
```

## セットアップ

1. Excelで新規ブックを作成
2. Alt + F11 でVBAエディタを開く
3. ファイル → ファイルのインポート で以下の順にインポート:
   - `FDE_Config.bas`
   - `FDE_Main.bas`
   - `FDE_Setup.bas`
4. マクロ有効ブック(.xlsm)として保存

## 使い方

### 1. 初期化

1. Alt + F8 でマクロダイアログを開く
2. `InitializeGit差分抽出ツール` を実行
3. メインシートが作成される

### 2. 設定入力

メインシートで以下を設定:

- **リポジトリパス**: Gitリポジトリのパス（環境変数%USERNAME%等も使用可）
- **出力先フォルダ**: 差分ファイルの出力先
- **比較元（修正前）**: ブランチ名またはコミットハッシュ
- **比較先（修正後）**: ブランチ名またはコミットハッシュ（HEADも可）

### 3. 比較実行

1. 「比較実行」ボタンをクリック
2. 「比較結果」シートに差分ファイル一覧が出力される

### 4. 差分ファイル抽出

1. 「差分ファイル抽出」ボタンをクリック
2. 出力先フォルダに差分ファイルがコピーされる

## 出力フォルダ構成

```
出力先フォルダ/
├── 01_修正前/        # 比較元（修正前）のファイル
│   └── (フォルダ構成を維持)
├── 02_修正後/        # 比較先（修正後）のファイル
│   └── (フォルダ構成を維持)
└── diff_report.txt   # 差分レポート
```

## 比較結果シートの見方

| 列 | 内容 |
|----|------|
| 抽出 | 抽出対象マーク（*） |
| 相対パス | ファイルの相対パス |
| ファイル名 | ファイル名 |
| 状態 | Git差分状態（A/M/D） |
| 修正前 | 比較元に存在するか |
| 修正後 | 比較先に存在するか |
| 変更種別 | 新規/変更/削除 |

### 行の色分け

- 黄色背景: 変更されたファイル
- 緑色背景: 新規追加されたファイル
- 赤色背景: 削除されたファイル

## バッチ版との違い

| 機能 | バッチ版 | VBA版 |
|------|----------|-------|
| 履歴保存 | なし | Excelシートに保存可能 |
| GUI | コマンドライン | Excelシート |
| WinMerge連携 | あり | なし（シートで確認） |
| コミット選択 | 対話式 | 直接入力 |

## 注意事項

- Gitがインストールされ、PATHが通っている必要があります
- 大量のファイルがある場合は処理に時間がかかることがあります
- バイナリファイルは正しく抽出されない場合があります

## ライセンス

このツールは個人利用を目的としています。
